import{i as I,r as i,n as v,t as p,G as w,af as x,l as y,J as f,bd as E,be as V}from"./index.85a18687.js";import{u as B}from"./use-quasar.bc7896a7.js";import{api as k}from"./axios.84dd43a9.js";import{a as A,n as C}from"./myFuncts.325243df.js";import{_ as R}from"./plugin-vue_export-helper.21dcd24c.js";const $={__name:"NickInput",setup(z){const r=B(),o=String("https://aa.dllib.ru/be/"),n=I("curAccount"),a=i(""),u=i(null),s=i("Input"),c=i(!1);function d(){return n.value.settings.publicNick.length<3?(a.value="\u041D\u0435 \u043A\u043E\u0440\u043E\u0447\u0435 3",u.value.validate(),!1):n.value.settings.publicNick.length>20?(a.value="\u041D\u0435 \u0434\u043B\u0438\u043D\u043D\u0435\u0435 20",u.value.validate(),!1):m()?(g(),!0):(u.value.validate(),!1)}function m(){let e=n.value.settings.publicNick,t=new RegExp("^([a-zA-Z\u0430-\u044F\u0410-\u042F\u0451\u04010-9]{3,20})$"),l=new RegExp("^([a-zA-Z0-9]{3,20})$"),h=new RegExp("^([\u0430-\u044F\u0410-\u042F\u0451\u04010-9]{3,20})$");if(l.test(e)||h.test(e))return a.value="",!0;if(t.test(e))return a.value="\u041D\u0435 \u0441\u043C\u0435\u0448\u0438\u0432\u0430\u0439\u0442\u0435 \u044F\u0437\u044B\u043A\u0438",!1;a.value="\u0422\u043E\u043B\u044C\u043A\u043E \u0431\u0443\u043A\u0432\u044B \u0438 \u0446\u0438\u0444\u0440\u044B"}function g(){k.post(o+"api/settings.php",{params:{method:"setNick",nick:n.value.settings.publicNick,save:!1}}).then(e=>{var t;if(!((t=e==null?void 0:e.data)!=null&&t.result))throw new Error;a.value="",u.value.validate()}).catch(e=>{var t,l;a.value=(l=(t=e==null?void 0:e.response)==null?void 0:t.data)!=null&&l.error?e.response.data.error:"\u0421\u0435\u0440\u0432\u0435\u0440 \u043D\u0435 \u043E\u0442\u0432\u0435\u0442\u0438\u043B",u.value.validate()})}function N(){u.value.blur(),k.post(o+"api/settings.php",{params:{method:"setNick",nick:n.value.settings.publicNick,save:!0}}).then(e=>{var t;if(!((t=e==null?void 0:e.data)!=null&&t.result))throw new Error;r.notify(A())}).catch(e=>{r.notify(C(e))})}function _(){s.value="Input InputActive",c.value=!0}function b(){s.value="Input",c.value=!1}return(e,t)=>(v(),p(V,{modelValue:f(n).settings.publicNick,"onUpdate:modelValue":[t[1]||(t[1]=l=>f(n).settings.publicNick=l),t[2]||(t[2]=l=>d())],ref_key:"nickRef",ref:u,label:"\u041F\u0443\u0431\u043B\u0438\u0447\u043D\u044B\u0439 \u043D\u0438\u043A",borderless:"",autocomplete:"off",class:E(s.value),onFocus:_,onBlur:b,rules:[l=>!a.value.length||a.value]},{append:w(()=>[!a.value&&c.value?(v(),p(x,{key:0,label:"Ok",class:"DefBtn",dense:"","no-caps":"",onClick:t[0]||(t[0]=l=>N())})):y("",!0)]),_:1},8,["modelValue","class","rules"]))}};var j=R($,[["__scopeId","data-v-595c315e"]]);export{j as N};
