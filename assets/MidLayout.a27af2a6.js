import{I as $e,c as p,h as Q,J as ze,K as ut,L as Xe,M as ct,N as Ye,O as st,i as K,P as Pe,r as C,Q as dt,R as ft,w as F,o as Le,n as Oe,S as vt,U as Ze,V as We,W as ht,g as et,X as gt,t as S,x as $,Y as c,f,Z as Ke,_ as z,$ as ye,a0 as x,a1 as mt,v as he,l as Y,a2 as tt,a3 as Ee,a4 as Qe,F as xe,a5 as Fe,b as De,a6 as ve,a7 as yt,a8 as kt,a9 as bt,aa as _t,ab as pt,ac as Re,ad as xt,ae as Ge,u as Ue,m as St,p as X,k as wt,q as Tt,af as He}from"./index.312bfc2c.js";import{Q as Ct}from"./QTabs.7abb20a1.js";import{Q as Lt,a as At}from"./QFooter.df916990.js";import{T as Me}from"./TouchPan.415f66fa.js";import{b as Be}from"./format.959830d0.js";import{Q as qt}from"./QPage.78244081.js";import{Q as Bt,a as Qt}from"./QLayout.ac72e935.js";import{api as Se}from"./axios.8ef9e684.js";import{P as $t}from"./LocalStorage.e71ba1e7.js";import{u as Ae}from"./use-quasar.d7abd3d3.js";import{Q as ne,a as le,b as Ce}from"./position-engine.7a2cb73f.js";import{Q as at}from"./QSelect.c60eb851.js";import{I as Ve}from"./ItemIcon.a357d1dd.js";import{Q as lt}from"./QImg.0a6cd497.js";import{d as Kt,n as we,a as It,b as Nt}from"./myFuncts.f85c9e09.js";import{Q as Pt,a as Mt}from"./QExpansionItem.a5e64d45.js";import{Q as Ot}from"./QList.2806152c.js";import"./QScrollObserver.a8aa26f4.js";import"./selection.bedc1144.js";import"./QMenu.3579dee4.js";var Et=$e({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:T}){const s=p(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>Q("div",{class:s.value},ze(T.default))}}),Ft=$e({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:T}){const s=p(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>Q("div",{class:s.value,role:"toolbar"},ze(T.default))}});const je=150;var Dt=$e({name:"QDrawer",inheritAttrs:!1,props:{...ut,...Xe,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...ct,"onLayout","miniState"],setup(e,{slots:T,emit:s,attrs:I}){const L=et(),{proxy:{$q:y}}=L,m=Ye(e,y),{preventBodyScroll:N}=gt(),{registerTimeout:O,removeTimeout:v}=st(),n=K(ht,Pe);if(n===Pe)return console.error("QDrawer needs to be child of QLayout"),Pe;let V,d=null,B;const k=C(e.behavior==="mobile"||e.behavior!=="desktop"&&n.totalWidth.value<=e.breakpoint),U=p(()=>e.mini===!0&&k.value!==!0),E=p(()=>U.value===!0?e.miniWidth:e.width),u=C(e.showIfAbove===!0&&k.value===!1?!0:e.modelValue===!0),W=p(()=>e.persistent!==!0&&(k.value===!0||ce.value===!0));function Z(l,b){if(Te(),l!==!1&&n.animate(),R(0),k.value===!0){const G=n.instances[A.value];G!==void 0&&G.belowBreakpoint===!0&&G.hide(!1),ee(1),n.isContainer.value!==!0&&N(!0)}else ee(0),l!==!1&&me(!1);O(()=>{l!==!1&&me(!0),b!==!0&&s("show",l)},je)}function ke(l,b){ue(),l!==!1&&n.animate(),ee(0),R(j.value*E.value),pe(),b!==!0?O(()=>{s("hide",l)},je):v()}const{show:ge,hide:re}=dt({showing:u,hideOnRouteChange:W,handleShow:Z,handleHide:ke}),{addToHistory:Te,removeFromHistory:ue}=ft(u,re,W),oe={belowBreakpoint:k,hide:re},H=p(()=>e.side==="right"),j=p(()=>(y.lang.rtl===!0?-1:1)*(H.value===!0?1:-1)),be=C(0),te=C(!1),i=C(!1),g=C(E.value*j.value),A=p(()=>H.value===!0?"left":"right"),q=p(()=>u.value===!0&&k.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:E.value:0),J=p(()=>e.overlay===!0||e.miniToOverlay===!0||n.view.value.indexOf(H.value?"R":"L")!==-1||y.platform.is.ios===!0&&n.isContainer.value===!0),ae=p(()=>e.overlay===!1&&u.value===!0&&k.value===!1),ce=p(()=>e.overlay===!0&&u.value===!0&&k.value===!1),_e=p(()=>"fullscreen q-drawer__backdrop"+(u.value===!1&&te.value===!1?" hidden":"")),a=p(()=>({backgroundColor:`rgba(0,0,0,${be.value*.4})`})),r=p(()=>H.value===!0?n.rows.value.top[2]==="r":n.rows.value.top[0]==="l"),t=p(()=>H.value===!0?n.rows.value.bottom[2]==="r":n.rows.value.bottom[0]==="l"),h=p(()=>{const l={};return n.header.space===!0&&r.value===!1&&(J.value===!0?l.top=`${n.header.offset}px`:n.header.space===!0&&(l.top=`${n.header.size}px`)),n.footer.space===!0&&t.value===!1&&(J.value===!0?l.bottom=`${n.footer.offset}px`:n.footer.space===!0&&(l.bottom=`${n.footer.size}px`)),l}),o=p(()=>{const l={width:`${E.value}px`,transform:`translateX(${g.value}px)`};return k.value===!0?l:Object.assign(l,h.value)}),w=p(()=>"q-drawer__content fit "+(n.isContainer.value!==!0?"scroll":"overflow-auto")),P=p(()=>`q-drawer q-drawer--${e.side}`+(i.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(m.value===!0?" q-drawer--dark q-dark":"")+(te.value===!0?" no-transition":u.value===!0?"":" q-layout--prevent-focus")+(k.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${U.value===!0?"mini":"standard"}`+(J.value===!0||ae.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(r.value===!0?" q-drawer--top-padding":""))),se=p(()=>{const l=y.lang.rtl===!0?e.side:A.value;return[[Me,_,void 0,{[l]:!0,mouse:!0}]]}),D=p(()=>{const l=y.lang.rtl===!0?A.value:e.side;return[[Me,M,void 0,{[l]:!0,mouse:!0}]]}),Ie=p(()=>{const l=y.lang.rtl===!0?A.value:e.side;return[[Me,M,void 0,{[l]:!0,mouse:!0,mouseAllDir:!0}]]});function de(){ot(k,e.behavior==="mobile"||e.behavior!=="desktop"&&n.totalWidth.value<=e.breakpoint)}F(k,l=>{l===!0?(V=u.value,u.value===!0&&re(!1)):e.overlay===!1&&e.behavior!=="mobile"&&V!==!1&&(u.value===!0?(R(0),ee(0),pe()):ge(!1))}),F(()=>e.side,(l,b)=>{n.instances[b]===oe&&(n.instances[b]=void 0,n[b].space=!1,n[b].offset=0),n.instances[l]=oe,n[l].size=E.value,n[l].space=ae.value,n[l].offset=q.value}),F(n.totalWidth,()=>{(n.isContainer.value===!0||document.qScrollPrevented!==!0)&&de()}),F(()=>e.behavior+e.breakpoint,de),F(n.isContainer,l=>{u.value===!0&&N(l!==!0),l===!0&&de()}),F(n.scrollbarWidth,()=>{R(u.value===!0?0:void 0)}),F(q,l=>{ie("offset",l)}),F(ae,l=>{s("onLayout",l),ie("space",l)}),F(H,()=>{R()}),F(E,l=>{R(),Ne(e.miniToOverlay,l)}),F(()=>e.miniToOverlay,l=>{Ne(l,E.value)}),F(()=>y.lang.rtl,()=>{R()}),F(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(fe(),n.animate())}),F(U,l=>{s("miniState",l)});function R(l){l===void 0?Oe(()=>{l=u.value===!0?0:E.value,R(j.value*l)}):(n.isContainer.value===!0&&H.value===!0&&(k.value===!0||Math.abs(l)===E.value)&&(l+=j.value*n.scrollbarWidth.value),g.value=l)}function ee(l){be.value=l}function me(l){const b=l===!0?"remove":n.isContainer.value!==!0?"add":"";b!==""&&document.body.classList[b]("q-body--drawer-toggle")}function fe(){d!==null&&clearTimeout(d),L.proxy&&L.proxy.$el&&L.proxy.$el.classList.add("q-drawer--mini-animate"),i.value=!0,d=setTimeout(()=>{d=null,i.value=!1,L&&L.proxy&&L.proxy.$el&&L.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function _(l){if(u.value!==!1)return;const b=E.value,G=Be(l.distance.x,0,b);if(l.isFinal===!0){G>=Math.min(75,b)===!0?ge():(n.animate(),ee(0),R(j.value*b)),te.value=!1;return}R((y.lang.rtl===!0?H.value!==!0:H.value)?Math.max(b-G,0):Math.min(0,G-b)),ee(Be(G/b,0,1)),l.isFirst===!0&&(te.value=!0)}function M(l){if(u.value!==!0)return;const b=E.value,G=l.direction===e.side,qe=(y.lang.rtl===!0?G!==!0:G)?Be(l.distance.x,0,b):0;if(l.isFinal===!0){Math.abs(qe)<Math.min(75,b)===!0?(n.animate(),ee(1),R(0)):re(),te.value=!1;return}R(j.value*qe),ee(Be(1-qe/b,0,1)),l.isFirst===!0&&(te.value=!0)}function pe(){N(!1),me(!0)}function ie(l,b){n.update(e.side,l,b)}function ot(l,b){l.value!==b&&(l.value=b)}function Ne(l,b){ie("size",l===!0?e.miniWidth:b)}return n.instances[e.side]=oe,Ne(e.miniToOverlay,E.value),ie("space",ae.value),ie("offset",q.value),e.showIfAbove===!0&&e.modelValue!==!0&&u.value===!0&&e["onUpdate:modelValue"]!==void 0&&s("update:modelValue",!0),Le(()=>{s("onLayout",ae.value),s("miniState",U.value),V=e.showIfAbove===!0;const l=()=>{(u.value===!0?Z:ke)(!1,!0)};if(n.totalWidth.value!==0){Oe(l);return}B=F(n.totalWidth,()=>{B(),B=void 0,u.value===!1&&e.showIfAbove===!0&&k.value===!1?ge(!1):l()})}),vt(()=>{B!==void 0&&B(),d!==null&&(clearTimeout(d),d=null),u.value===!0&&pe(),n.instances[e.side]===oe&&(n.instances[e.side]=void 0,ie("size",0),ie("offset",0),ie("space",!1))}),()=>{const l=[];k.value===!0&&(e.noSwipeOpen===!1&&l.push(Ze(Q("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),se.value)),l.push(We("div",{ref:"backdrop",class:_e.value,style:a.value,"aria-hidden":"true",onClick:re},void 0,"backdrop",e.noSwipeBackdrop!==!0&&u.value===!0,()=>Ie.value)));const b=U.value===!0&&T.mini!==void 0,G=[Q("div",{...I,key:""+b,class:[w.value,I.class]},b===!0?T.mini():ze(T.default))];return e.elevated===!0&&u.value===!0&&G.push(Q("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(We("aside",{ref:"content",class:P.value,style:o.value},G,"contentclose",e.noSwipeClose!==!0&&k.value===!0,()=>D.value)),Q("div",{class:"q-drawer-container"},l)}}});const nt={__name:"DynamicFormItem",props:{btnLabel:String,icon:String,url:String},setup(e){Ae();const T=e,s=K("AccessToken"),I=K("SessionToken");return(L,y)=>(S(),$(Ce,{clickable:"",dark:"",onClick:y[0]||(y[0]=m=>x(Kt)(e.url,{AccessToken:x(s),SessionToken:x(I)}))},{default:c(()=>[f(ne,{avatar:""},{default:c(()=>[f(Ke,null,{default:c(()=>[f(lt,{src:e.icon},null,8,["src"])]),_:1})]),_:1}),f(ne,null,{default:c(()=>[f(le,{caption:""},{default:c(()=>y[1]||(y[1]=[z("\u0412\u043E\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437")])),_:1}),f(le,null,{default:c(()=>[z(ye(T.btnLabel),1)]),_:1})]),_:1})]),_:1}))}},Vt={key:0,style:{width:"40px"}},it={__name:"AccountSelector",emits:["onSelectAccount"],setup(e,{emit:T}){Ae();const s=String("https://auth.symphograph.ru/"),I=K("ServerGroupList"),L=K("AccountList");function y(){return L.value.filter(V=>V.authType!=="deefault")}const m=K("curAccount");C({id:1,nickName:"\u041D\u0435 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D",avatar:"init_ava.png",grade:1,serverId:9});const N=K("authTypes"),O=C(null),v=K("reLogin");function n(V){return I.value.find(d=>d.id===V)}return Le(()=>{console.log(y())}),(V,d)=>{var B,k,U,E;return(B=y())!=null&&B.length?(S(),$(at,{key:0,modelValue:x(m),"onUpdate:modelValue":[d[0]||(d[0]=u=>De(m)?m.value=u:null),d[1]||(d[1]=u=>x(v)(x(m).id,x(m).authType))],style:{"min-width":"16em"},ref_key:"selector",ref:O,dark:"","label-color":"grey",filled:"",label:(E=(U=(k=x(m))==null?void 0:k.settings)==null?void 0:U.publicNick)!=null?E:"dsd",options:y(),"option-value":"id","map-options":"","option-label":"nickName"},mt({"before-options":c(()=>[f(Ce,{clickable:"",to:"/accounts"},{default:c(()=>[f(ne,{avatar:""},{default:c(()=>[f(Ke,{icon:"ionicon person outline"})]),_:1}),f(ne,null,{default:c(()=>[f(le,{caption:"",class:"text-grey"},{default:c(()=>d[2]||(d[2]=[z("\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430\u043C\u0438")])),_:1}),f(le,null,{default:c(()=>d[3]||(d[3]=[z("\u041F\u0440\u043E\u0444\u0438\u043B\u044C")])),_:1})]),_:1})]),_:1})]),option:c(u=>[u.opt.id!==x(m).id&&u.opt.authType!=="default"?(S(),$(Ce,tt(Ee({key:0},u.itemProps)),{default:c(()=>[f(ne,{avatar:""},{default:c(()=>[f(Ve,{locIcon:x(s)+u.opt.Avatar.src,grade:1,size:"70px"},null,8,["locIcon"])]),_:2},1024),f(ne,null,{default:c(()=>[f(le,{caption:"",class:"text-grey-9"},{default:c(()=>[d[4]||(d[4]=z(" \u0412\u043E\u0439\u0442\u0438 \u043A\u0430\u043A ")),f(Qe,{name:"img:/img/auth/"+u.opt.authType+".svg"},null,8,["name"])]),_:2},1024),f(le,null,{default:c(()=>[z(ye(u.opt.nickName),1)]),_:2},1024),f(le,{caption:"",class:"text-grey-6"},{default:c(()=>{var W,Z;return[z(ye((Z=(W=u.opt.settings)==null?void 0:W.publicNick)!=null?Z:""),1)]}),_:2},1024),f(le,{caption:"",class:"text-grey-9"},{default:c(()=>{var W;return[z(ye(n((W=u.opt.settings)==null?void 0:W.serverGroupId).label),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)):Y("",!0)]),"after-options":c(()=>[(S(!0),he(xe,null,Fe(x(N),u=>(S(),he("div",{key:u.id},[f(nt,{btnLabel:u.label,icon:u.img,url:x(s)+u.url},null,8,["btnLabel","icon","url"])]))),128))]),_:2},[x(m)?{name:"append",fn:c(()=>[x(m).Avatar?(S(),he("div",Vt,[f(Ve,{locIcon:x(s)+x(m).Avatar.src,grade:x(m).settings.grade},null,8,["locIcon","grade"])])):Y("",!0)]),key:"0"}:void 0]),1032,["modelValue","label","options"])):Y("",!0)}}},rt={__name:"LoginList",setup(e){const T=String("https://auth.symphograph.ru/"),s=K("authTypes");K("AccessToken"),K("SessionToken");const I=C(null);return(L,y)=>(S(),$(at,{modelValue:I.value,"onUpdate:modelValue":y[0]||(y[0]=m=>I.value=m),options:x(s),"map-options":"",label:"\u0412\u043E\u0439\u0442\u0438",style:{"min-width":"16em"},ref:"selector",dark:"",filled:"","option-value":"id","label-color":"grey"},{option:c(m=>[ve("div",tt(yt(m.itemProps)),[f(nt,{btnLabel:m.opt.label,icon:m.opt.img,url:x(T)+m.opt.url},null,8,["btnLabel","icon","url"])],16)]),_:1},8,["modelValue","options"]))}},Je={__name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""},ava:{type:String,default:""},children:{type:Array,default:()=>[]}},setup(e){return(T,s)=>(S(),$(Ce,{clickable:"",tag:"a",to:e.link,dark:""},{default:c(()=>[e.icon||e.ava?(S(),$(ne,{key:0,avatar:""},{default:c(()=>[e.icon?(S(),$(Qe,{key:0,name:e.icon},null,8,["name"])):Y("",!0),e.ava?(S(),$(Ke,{key:1},{default:c(()=>[f(lt,{src:e.ava,ratio:30/30},null,8,["src"])]),_:1})):Y("",!0)]),_:1})):Y("",!0),f(ne,null,{default:c(()=>[f(le,null,{default:c(()=>[z(ye(e.title),1)]),_:1}),f(le,{caption:""},{default:c(()=>[z(ye(e.caption),1)]),_:1})]),_:1})]),_:1},8,["to"]))}},zt=["none","strict","leaf","leaf-filtered"];var Ut=$e({name:"QTree",props:{...Xe,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>zt.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:{},noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:T,emit:s}){const{proxy:I}=et(),{$q:L}=I,y=Ye(e,L),m=C({}),N=C(e.ticked||[]),O=C(e.expanded||[]);let v={};kt(()=>{v={}});const n=p(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(y.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),V=p(()=>e.selected!==void 0),d=p(()=>e.icon||L.iconSet.tree.icon),B=p(()=>e.controlColor||e.color),k=p(()=>e.textColor!==void 0?` text-${e.textColor}`:""),U=p(()=>{const a=e.selectedColor||e.color;return a?` text-${a}`:""}),E=p(()=>e.filterMethod!==void 0?e.filterMethod:(a,r)=>{const t=r.toLowerCase();return a[e.labelKey]&&a[e.labelKey].toLowerCase().indexOf(t)!==-1}),u=p(()=>{const a={},r=(t,h)=>{const o=t.tickStrategy||(h?h.tickStrategy:e.tickStrategy),w=t[e.nodeKey],P=t[e.childrenKey]&&Array.isArray(t[e.childrenKey])&&t[e.childrenKey].length!==0,se=t.disabled!==!0&&V.value===!0&&t.selectable!==!1,D=t.disabled!==!0&&t.expandable!==!1,Ie=o!=="none",de=o==="strict",R=o==="leaf-filtered",ee=o==="leaf"||o==="leaf-filtered";let me=t.disabled!==!0&&t.tickable!==!1;ee===!0&&me===!0&&h&&h.tickable!==!0&&(me=!1);let fe=t.lazy;fe===!0&&m.value[w]!==void 0&&Array.isArray(t[e.childrenKey])===!0&&(fe=m.value[w]);const _={key:w,parent:h,isParent:P,lazy:fe,disabled:t.disabled,link:t.disabled!==!0&&(se===!0||D===!0&&(P===!0||fe===!0)),children:[],matchesFilter:e.filter?E.value(t,e.filter):!0,selected:w===e.selected&&se===!0,selectable:se,expanded:P===!0?O.value.includes(w):!1,expandable:D,noTick:t.noTick===!0||de!==!0&&fe&&fe!=="loaded",tickable:me,tickStrategy:o,hasTicking:Ie,strictTicking:de,leafFilteredTicking:R,leafTicking:ee,ticked:de===!0?N.value.includes(w):P===!0?!1:N.value.includes(w)};if(a[w]=_,P===!0&&(_.children=t[e.childrenKey].map(M=>r(M,_)),e.filter&&(_.matchesFilter!==!0?_.matchesFilter=_.children.some(M=>M.matchesFilter):_.noTick!==!0&&_.disabled!==!0&&_.tickable===!0&&R===!0&&_.children.every(M=>M.matchesFilter!==!0||M.noTick===!0||M.tickable!==!0)===!0&&(_.tickable=!1)),_.matchesFilter===!0&&(_.noTick!==!0&&de!==!0&&_.children.every(M=>M.noTick)===!0&&(_.noTick=!0),ee))){if(_.ticked=!1,_.indeterminate=_.children.some(M=>M.indeterminate===!0),_.tickable=_.tickable===!0&&_.children.some(M=>M.tickable),_.indeterminate!==!0){const M=_.children.reduce((pe,ie)=>ie.ticked===!0?pe+1:pe,0);M===_.children.length?_.ticked=!0:M>0&&(_.indeterminate=!0)}_.indeterminate===!0&&(_.indeterminateNextState=_.children.every(M=>M.tickable!==!0||M.ticked!==!0))}return _};return e.nodes.forEach(t=>r(t,null)),a});F(()=>e.ticked,a=>{N.value=a}),F(()=>e.expanded,a=>{O.value=a});function W(a){const r=[].reduce,t=(h,o)=>{if(h||!o)return h;if(Array.isArray(o)===!0)return r.call(Object(o),t,h);if(o[e.nodeKey]===a)return o;if(o[e.childrenKey])return t(null,o[e.childrenKey])};return t(null,e.nodes)}function Z(){return N.value.map(a=>W(a))}function ke(){return O.value.map(a=>W(a))}function ge(a){return a&&u.value[a]?u.value[a].expanded:!1}function re(){e.expanded!==void 0?s("update:expanded",[]):O.value=[]}function Te(){const a=[],r=t=>{t[e.childrenKey]&&t[e.childrenKey].length!==0&&t.expandable!==!1&&t.disabled!==!0&&(a.push(t[e.nodeKey]),t[e.childrenKey].forEach(r))};e.nodes.forEach(r),e.expanded!==void 0?s("update:expanded",a):O.value=a}function ue(a,r,t=W(a),h=u.value[a]){if(h.lazy&&h.lazy!=="loaded"){if(h.lazy==="loading")return;m.value[a]="loading",Array.isArray(t[e.childrenKey])!==!0&&(t[e.childrenKey]=[]),s("lazyLoad",{node:t,key:a,done:o=>{m.value[a]="loaded",t[e.childrenKey]=Array.isArray(o)===!0?o:[],Oe(()=>{const w=u.value[a];w&&w.isParent===!0&&oe(a,!0)})},fail:()=>{delete m.value[a],t[e.childrenKey].length===0&&delete t[e.childrenKey]}})}else h.isParent===!0&&h.expandable===!0&&oe(a,r)}function oe(a,r){let t=O.value;const h=e.expanded!==void 0;if(h===!0&&(t=t.slice()),r){if(e.accordion&&u.value[a]){const o=[];u.value[a].parent?u.value[a].parent.children.forEach(w=>{w.key!==a&&w.expandable===!0&&o.push(w.key)}):e.nodes.forEach(w=>{const P=w[e.nodeKey];P!==a&&o.push(P)}),o.length!==0&&(t=t.filter(w=>o.includes(w)===!1))}t=t.concat([a]).filter((o,w,P)=>P.indexOf(o)===w)}else t=t.filter(o=>o!==a);h===!0?s("update:expanded",t):O.value=t}function H(a){return a&&u.value[a]?u.value[a].ticked:!1}function j(a,r){let t=N.value;const h=e.ticked!==void 0;h===!0&&(t=t.slice()),r?t=t.concat(a).filter((o,w,P)=>P.indexOf(o)===w):t=t.filter(o=>a.includes(o)===!1),h===!0&&s("update:ticked",t)}function be(a,r,t){const h={tree:I,node:a,key:t,color:e.color,dark:y.value};return Ge(h,"expanded",()=>r.expanded,o=>{o!==r.expanded&&ue(t,o)}),Ge(h,"ticked",()=>r.ticked,o=>{o!==r.ticked&&j([t],o)}),h}function te(a){return(e.filter?a.filter(r=>u.value[r[e.nodeKey]].matchesFilter):a).map(r=>q(r))}function i(a){if(a.icon!==void 0)return Q(Qe,{class:"q-tree__icon q-mr-sm",name:a.icon,color:a.iconColor});const r=a.img||a.avatar;if(r)return Q("img",{class:`q-tree__${a.img?"img":"avatar"} q-mr-sm`,src:r})}function g(){s("afterShow")}function A(){s("afterHide")}function q(a){const r=a[e.nodeKey],t=u.value[r],h=a.header&&T[`header-${a.header}`]||T["default-header"],o=t.isParent===!0?te(a[e.childrenKey]):[],w=o.length!==0||t.lazy&&t.lazy!=="loaded";let P=a.body&&T[`body-${a.body}`]||T["default-body"];const se=h!==void 0||P!==void 0?be(a,t,r):null;return P!==void 0&&(P=Q("div",{class:"q-tree__node-body relative-position"},[Q("div",{class:k.value},[P(se)])])),Q("div",{key:r,class:`q-tree__node relative-position q-tree__node--${w===!0?"parent":"child"}`},[Q("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(t.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(t.selected===!0?" q-tree__node--selected":"")+(t.disabled===!0?" q-tree__node--disabled":""),tabindex:t.link===!0?0:-1,ariaExpanded:o.length>0?t.expanded:null,role:"treeitem",onClick:D=>{ae(a,t,D)},onKeypress(D){bt(D)!==!0&&(D.keyCode===13?ae(a,t,D,!0):D.keyCode===32&&ce(a,t,D,!0))}},[Q("div",{class:"q-focus-helper",tabindex:-1,ref:D=>{v[t.key]=D}}),t.lazy==="loading"?Q(_t,{class:"q-tree__spinner",color:B.value}):w===!0?Q(Qe,{class:"q-tree__arrow"+(t.expanded===!0?" q-tree__arrow--rotate":""),name:d.value,onClick(D){ce(a,t,D)}}):null,t.hasTicking===!0&&t.noTick!==!0?Q(pt,{class:"q-tree__tickbox",modelValue:t.indeterminate===!0?null:t.ticked,color:B.value,dark:y.value,dense:!0,keepColor:!0,disable:t.tickable!==!0,onKeydown:Re,"onUpdate:modelValue":D=>{_e(t,D)}}):null,Q("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(t.selected===!0?U.value:k.value)},[h?h(se):[i(a),Q("div",a[e.labelKey])]])]),w===!0?e.noTransition===!0?t.expanded===!0?Q("div",{class:"q-tree__node-collapsible"+k.value,key:`${r}__q`},[P,Q("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]):null:Q(Pt,{duration:e.duration,onShow:g,onHide:A},()=>Ze(Q("div",{class:"q-tree__node-collapsible"+k.value,key:`${r}__q`},[P,Q("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]),[[xt,t.expanded]])):P])}function J(a){const r=v[a];r&&r.focus()}function ae(a,r,t,h){h!==!0&&r.selectable!==!1&&J(r.key),V.value&&r.selectable?e.noSelectionUnset===!1?s("update:selected",r.key!==e.selected?r.key:null):r.key!==e.selected&&s("update:selected",r.key===void 0?null:r.key):ce(a,r,t,h),typeof a.handler=="function"&&a.handler(a)}function ce(a,r,t,h){t!==void 0&&Re(t),h!==!0&&r.selectable!==!1&&J(r.key),ue(r.key,!r.expanded,a,r)}function _e(a,r){if(a.indeterminate===!0&&(r=a.indeterminateNextState),a.strictTicking)j([a.key],r);else if(a.leafTicking){const t=[],h=o=>{o.isParent?(r!==!0&&o.noTick!==!0&&o.tickable===!0&&t.push(o.key),o.leafTicking===!0&&o.children.forEach(h)):o.noTick!==!0&&o.tickable===!0&&(o.leafFilteredTicking!==!0||o.matchesFilter===!0)&&t.push(o.key)};h(a),j(t,r)}}return e.defaultExpandAll===!0&&Te(),Object.assign(I,{getNodeByKey:W,getTickedNodes:Z,getExpandedNodes:ke,isExpanded:ge,collapseAll:re,expandAll:Te,setExpanded:ue,isTicked:H,setTicked:j}),()=>{const a=te(e.nodes);return Q("div",{class:n.value,role:"tree"},a.length===0?e.filter?e.noResultsLabel||L.lang.tree.noResults:e.noNodesLabel||L.lang.tree.noNodes:a)}}});const Wt={__name:"CategoryTree",setup(e){const T=Ae(),s=String("https://api.aa.dllib.ru/"),I=Ue(),L=St(),y=K("CategoriesList"),m=K("expandedCategNode"),N=K("selCategId"),O=K("selCategNode"),v=C(null);K("categMode"),F(N,()=>{if(!v.value)return;let d=v.value.getNodeByKey(N.value);if(d){let B=v.value.getNodeByKey(d.parent);O.value=d,m.value=[B.parent,d.parent]}else O.value=null},{deep:!0}),Le(()=>{V()});function n(){I.path!=="/category"&&L.push({path:"/category"})}function V(){Se.post(s+"api/options.php",{params:{method:"getCategories"}}).then(d=>{var B,k,U;if(!((B=d==null?void 0:d.data)!=null&&B.result))throw new Error;d.data.result&&(y.value=(U=(k=d==null?void 0:d.data)==null?void 0:k.data)!=null?U:[])}).catch(d=>{T.notify(we(d,"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u043D\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u043B\u0438\u0441\u044C"))})}return(d,B)=>x(y)?(S(),$(Ce,{key:0,separator:"",dark:""},{default:c(()=>[f(ne,null,{default:c(()=>[f(Ut,{dark:"",color:"gray","control-color":"black",ref_key:"tree",ref:v,accordion:"",nodes:x(y),"label-key":"name",expanded:x(m),"onUpdate:expanded":B[0]||(B[0]=k=>De(m)?m.value=k:null),selected:x(N),"onUpdate:selected":[B[1]||(B[1]=k=>De(N)?N.value=k:null),n],"no-transition":"","selected-color":"orange","node-key":"id",dense:""},null,8,["nodes","expanded","selected"])]),_:1})]),_:1})):Y("",!0)}},Rt=["src"],Gt={__name:"DrawerContent",setup(e){const T=Ue(),s=Ae(),I=K("AccountList"),L=[{title:"\u041F\u0430\u043A\u0438",caption:"\u0420\u0430\u0441\u043A\u0440\u044B\u0432\u0430\u0435\u043C\u044B\u0439",ava:"/img/pack.png",children:[{title:"\u041F\u0430\u043A\u0438",caption:"\u0422\u0430\u0431\u043B\u0438\u0446\u0430 \u043F\u0430\u043A\u043E\u0432",ava:"/img/pack.png",link:"/packs"},{title:"\u041F\u0430\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u041A\u0430\u043B\u044C\u043A\u0443\u043B\u044F\u0442\u043E\u0440 \u043F\u0430\u043A\u043E\u0432",ava:"/img/packmaker.png",link:"/packinfo"}]},{title:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B",caption:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0441\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438",ava:"/img/crafcul.png",children:[{title:"\u041A\u0440\u0430\u0444\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0441\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438",link:"/item/"},{title:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",caption:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B \u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",link:"/category"}]},{title:"\u041C\u043E\u0438 \u0446\u0435\u043D\u044B",caption:"\u0426\u0435\u043D\u044B \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u043E\u0432",ava:"/img/myprices.png",link:"/myprices/"},{title:"\u0421\u043E\u043E\u0431\u0449\u0435\u0441\u0442\u0432\u043E",caption:"\u0426\u0435\u043D\u044B \u0438\u0433\u0440\u043E\u043A\u043E\u0432",ava:"/img/community.png",link:"/members"},{title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",caption:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u0442\u0435 \u0441\u0432\u043E\u0438 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B",ava:"/img/settings.png",link:"/settings"}],y=K("ServerGroupList"),m=p(()=>!!T.path.match(/^\/item\//)||!!T.path.match(/^\/category/));return Le(()=>{}),(N,O)=>(S(),he(xe,null,[x(s).platform.is.mobile?(S(),he(xe,{key:0},[x(I)&&x(I).some(v=>v.authType!=="default")?(S(),$(it,{key:0})):(S(),$(rt,{key:1}))],64)):Y("",!0),f(Ot,{separator:""},{default:c(()=>[f(le,{header:""},{default:c(()=>O[0]||(O[0]=[z(" Graph Tools ")])),_:1}),(S(),he(xe,null,Fe(L,v=>(S(),he(xe,{key:v.title},[(v==null?void 0:v.children)&&(v==null?void 0:v.children.length)?(S(),$(Mt,{key:0,"content-inset-level":.2,"expand-separator":"",label:v.title,caption:v.caption,"default-closed":""},{header:c(()=>[v!=null&&v.ava?(S(),$(ne,{key:0,avatar:""},{default:c(()=>[f(Ke,null,{default:c(()=>[ve("img",{src:v.ava},null,8,Rt)]),_:2},1024)]),_:2},1024)):Y("",!0),f(ne,null,{default:c(()=>[z(ye(v.title),1)]),_:2},1024)]),default:c(()=>[(S(!0),he(xe,null,Fe(v.children,n=>(S(),$(Je,Ee({key:n.title,ref_for:!0},n,{title:n.title}),null,16,["title"]))),128))]),_:2},1032,["label","caption"])):(S(),$(Je,Ee({key:v.title,ref_for:!0},v,{title:v.title}),null,16,["title"]))],64))),64)),m.value&&x(y).length?(S(),$(Wt,{key:0})):Y("",!0)]),_:1})],64))}},Ht={class:"col"},jt={class:"column full-height"},ya={__name:"MidLayout",emits:["reLogin"],setup(e,{emit:T}){const s=Ae(),I=String("https://api.aa.dllib.ru/"),L=String("https://auth.symphograph.ru/"),y=Ue();K("progress");const m=K("AccessToken"),N=K("isOptionsLoaded");K("isTokenRefreshed"),K("isAccountsLoaded");const O=T,v=C([]);X("AccountList",v);const n=C({settings:{}});X("curAccount",n);const V=C({});X("AccSets",V);const d=C([]);X("AccSetList",d);const B=C([]);X("ServerGroupList",B);function k(){let i=v.value.map(g=>{const A=d.value.find(q=>q.accountId===g.id);return A?{...g,settings:A}:g});v.value=i.sort((g,A)=>new Date(A.visitedAt)-new Date(g.visitedAt))}const U=C(0);X("selCategId",U);const E=C(null);X("selCategNode",E);const u=C([]);X("ProfLvls",u);const W=C([{id:2,label:"\u0422\u0435\u043B\u0435\u0433\u0440\u0430\u043C",url:"auth/telegram/login.php",img:"/img/auth/telegram.svg"},{id:3,label:"MailRu",url:"auth/mailru/login.php",img:"/img/auth/mailru.svg"},{id:4,label:"Discord",url:"auth/discord/login.php",img:"/img/auth/discord.svg"},{id:4,label:"V\u041A\u043E\u043D\u0442\u0430\u043A\u0442\u0435",url:"auth/vkontakte/login.php",img:"/img/auth/vkontakte.svg"}]);X("authTypes",W);const Z=C(!1),ke=C(null);X("CategoriesList",ke);const ge=C([]);X("expandedCategNode",ge);const re=C(!1);X("categMode",re),X("selectOptionsStyle",{backgroundColor:"rgb(181 238 8 / 93%)",color:"#4B3A23"});function ue(){Z.value=!Z.value}function oe(){Se.post(I+"api/options.php",{params:{method:"getMain"}}).then(i=>{var g,A,q,J,ae,ce,_e;if(!((g=i==null?void 0:i.data)!=null&&g.result))throw new Error;B.value=(J=(q=(A=i==null?void 0:i.data)==null?void 0:A.data)==null?void 0:q.ServerGroupList)!=null?J:[],u.value=(_e=(ce=(ae=i==null?void 0:i.data)==null?void 0:ae.data)==null?void 0:ce.ProfLvls)!=null?_e:[],j()}).catch(i=>{s.notify(we(i))})}function H(){Se.post(L+"api/test.php",{params:{method:"get"}}).then(i=>{var g;if(!((g=i==null?void 0:i.data)!=null&&g.result))throw new Error;s.notify(Nt(i.data.result))}).catch(i=>{s.notify(we(i))})}function j(){Se.post(L+"api/account.php",{params:{method:"list"}}).then(i=>{var A,q;if(!((A=i==null?void 0:i.data)!=null&&A.result))throw new Error;let g=(q=i==null?void 0:i.data)==null?void 0:q.data;n.value=g.find(J=>J.id===It(m.value)),v.value=g.filter(J=>J.authType!=="default"),be()}).catch(i=>{s.notify(we(i))})}function be(){Se.post(I+"api/settings.php",{params:{method:"get"}}).then(i=>{var g,A,q;if(!((g=i==null?void 0:i.data)!=null&&g.result))throw new Error;V.value=(A=i==null?void 0:i.data)==null?void 0:A.data,n.value.settings=(q=i==null?void 0:i.data)==null?void 0:q.data,te()}).catch(i=>{s.notify(we(i))})}function te(){Se.post(I+"api/settings.php",{params:{method:"list",ids:v.value.map(i=>i.id)}}).then(i=>{var g,A,q;if(!((g=i==null?void 0:i.data)!=null&&g.result))throw new Error;d.value=(q=(A=i==null?void 0:i.data)==null?void 0:A.data)!=null?q:[],k(),N.value=!0}).catch(i=>{s.notify(we(i))})}return F(y,i=>{$t.set("lastPath",i.path)}),wt(()=>{}),Le(()=>{oe()}),(i,g)=>{const A=Tt("router-view");return x(N)?(S(),$(Bt,{key:0,view:"lHh Lpr lFf"},{default:c(()=>[f(Lt,{elevated:""},{default:c(()=>[f(Ft,null,{default:c(()=>[f(He,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:ue}),f(Et,null,{default:c(()=>g[3]||(g[3]=[z(" GraphTools ")])),_:1}),g[4]||(g[4]=ve("div",{style:{margin:"auto",color:"red"}},"* \u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u043A\u0435 *",-1)),x(s).platform.is.desktop?(S(),$(Ct,{key:0,"inline-label":"",class:"bg-primary text-white shadow-2",align:"center"},{default:c(()=>[f(He,{label:"test",onClick:g[0]||(g[0]=q=>H())}),v.value&&v.value.some(q=>q.authType!=="default")?(S(),$(it,{key:0,onOnSelectAccount:g[1]||(g[1]=q=>O("reLogin"))})):(S(),$(rt,{key:1}))]),_:1})):(S(),$(Ve,{key:1,locIcon:x(L)+n.value.Avatar.src,grade:V.value.grade,onClick:ue},null,8,["locIcon","grade"]))]),_:1})]),_:1}),f(Dt,{modelValue:Z.value,"onUpdate:modelValue":g[2]||(g[2]=q=>Z.value=q),"show-if-above":"",behavior:"default",bordered:"",dark:""},{default:c(()=>[f(Gt)]),_:1},8,["modelValue"]),n.value?(S(),$(Qt,{key:0},{default:c(()=>[f(qt,{class:"row no-wrap"},{default:c(()=>[ve("div",Ht,[ve("div",jt,[x(N)?(S(),$(A,{key:0})):Y("",!0)])])]),_:1})]),_:1})):Y("",!0),f(At,null,{default:c(()=>g[5]||(g[5]=[ve("div",{class:"footer"},[z("\xA9 "),ve("a",{href:"https://vk.com/roman_chubich",target:"_blank"},"\u0413\u0440\u0430\u0444"),z(" * "),ve("a",{href:"https://github.com/symphograph/ArcheAgeTools_Frontend",target:"_blank"},"Github"),z(" * \u0428\u0430\u0435\u0434\u0430 ")],-1)])),_:1})]),_:1})):Y("",!0)}}};export{ya as default};
