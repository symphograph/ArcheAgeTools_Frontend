import{H as Qe,c as _,h as B,I as ze,J as ut,K as Xe,L as ct,M as Ye,N as st,i as I,O as Pe,P as dt,r as L,Q as ft,R as vt,w as F,o as Ce,n as Oe,S as ht,U as Ze,V as We,g as et,W as gt,s as S,v as K,X as c,f as d,Y as $e,Z as U,_ as ke,$ as x,a0 as mt,t as fe,l as X,a1 as tt,a2 as Ee,a3 as Be,F as xe,a4 as Fe,b as De,a5 as ve,a6 as yt,a7 as kt,a8 as bt,a9 as _t,aa as pt,ab as Re,ac as xt,ad as Ge,u as Ue,m as St,p as J,k as wt,q as Tt,ae as He}from"./index.5175d5c0.js";import{Q as Ct}from"./QTabs.475cf5e5.js";import{Q as Lt,a as At}from"./QFooter.61b3ed0a.js";import{T as Me}from"./TouchPan.f946615c.js";import{b as qe}from"./format.865294d5.js";import{Q as qt}from"./QPage.218b0a2f.js";import{Q as Bt,a as Qt}from"./QLayout.821291ff.js";import{api as Se}from"./axios.c53f7cff.js";import{P as $t}from"./LocalStorage.208915d4.js";import{u as Le}from"./use-quasar.0c941a1e.js";import{Q as ae,a as te,b as Te}from"./position-engine.a34c8035.js";import{Q as at}from"./QSelect.3b931d71.js";import{I as Ve}from"./ItemIcon.8bf8c544.js";import{Q as lt}from"./QImg.1679b30e.js";import{d as Kt,n as we,a as It,b as Nt}from"./myFuncts.80e53bd5.js";import{Q as Pt,a as Mt}from"./QExpansionItem.6ef453ae.js";import{Q as Ot}from"./QList.a850d90c.js";import"./QScrollObserver.cf12e2de.js";import"./selection.50e195ba.js";import"./QMenu.12801ee8.js";var Et=Qe({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:T}){const s=_(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>B("div",{class:s.value},ze(T.default))}}),Ft=Qe({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:T}){const s=_(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>B("div",{class:s.value,role:"toolbar"},ze(T.default))}});const je=150;var Dt=Qe({name:"QDrawer",inheritAttrs:!1,props:{...ut,...Xe,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...ct,"onLayout","miniState"],setup(e,{slots:T,emit:s,attrs:N}){const A=et(),{proxy:{$q:p}}=A,h=Ye(e,p),{preventBodyScroll:P}=gt(),{registerTimeout:q,removeTimeout:f}=st(),i=I(dt,Pe);if(i===Pe)return console.error("QDrawer needs to be child of QLayout"),Pe;let z,g=null,Q;const m=L(e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint),W=_(()=>e.mini===!0&&m.value!==!0),E=_(()=>W.value===!0?e.miniWidth:e.width),u=L(e.showIfAbove===!0&&m.value===!1?!0:e.modelValue===!0),D=_(()=>e.persistent!==!0&&(m.value===!0||ue.value===!0));function ne(l,k){if(ge(),l!==!1&&i.animate(),R(0),m.value===!0){const G=i.instances[C.value];G!==void 0&&G.belowBreakpoint===!0&&G.hide(!1),Z(1),i.isContainer.value!==!0&&P(!0)}else Z(0),l!==!1&&ye(!1);q(()=>{l!==!1&&ye(!0),k!==!0&&s("show",l)},je)}function be(l,k){me(),l!==!1&&i.animate(),Z(0),R(j.value*E.value),pe(),k!==!0?q(()=>{s("hide",l)},je):f()}const{show:he,hide:oe}=ft({showing:u,hideOnRouteChange:D,handleShow:ne,handleHide:be}),{addToHistory:ge,removeFromHistory:me}=vt(u,oe,D),ie={belowBreakpoint:m,hide:oe},H=_(()=>e.side==="right"),j=_(()=>(p.lang.rtl===!0?-1:1)*(H.value===!0?1:-1)),_e=L(0),n=L(!1),y=L(!1),$=L(E.value*j.value),C=_(()=>H.value===!0?"left":"right"),Y=_(()=>u.value===!0&&m.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:E.value:0),re=_(()=>e.overlay===!0||e.miniToOverlay===!0||i.view.value.indexOf(H.value?"R":"L")>-1||p.platform.is.ios===!0&&i.isContainer.value===!0),ee=_(()=>e.overlay===!1&&u.value===!0&&m.value===!1),ue=_(()=>e.overlay===!0&&u.value===!0&&m.value===!1),Ke=_(()=>"fullscreen q-drawer__backdrop"+(u.value===!1&&n.value===!1?" hidden":"")),a=_(()=>({backgroundColor:`rgba(0,0,0,${_e.value*.4})`})),r=_(()=>H.value===!0?i.rows.value.top[2]==="r":i.rows.value.top[0]==="l"),t=_(()=>H.value===!0?i.rows.value.bottom[2]==="r":i.rows.value.bottom[0]==="l"),v=_(()=>{const l={};return i.header.space===!0&&r.value===!1&&(re.value===!0?l.top=`${i.header.offset}px`:i.header.space===!0&&(l.top=`${i.header.size}px`)),i.footer.space===!0&&t.value===!1&&(re.value===!0?l.bottom=`${i.footer.offset}px`:i.footer.space===!0&&(l.bottom=`${i.footer.size}px`)),l}),o=_(()=>{const l={width:`${E.value}px`,transform:`translateX(${$.value}px)`};return m.value===!0?l:Object.assign(l,v.value)}),w=_(()=>"q-drawer__content fit "+(i.isContainer.value!==!0?"scroll":"overflow-auto")),M=_(()=>`q-drawer q-drawer--${e.side}`+(y.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(h.value===!0?" q-drawer--dark q-dark":"")+(n.value===!0?" no-transition":u.value===!0?"":" q-layout--prevent-focus")+(m.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${W.value===!0?"mini":"standard"}`+(re.value===!0||ee.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(r.value===!0?" q-drawer--top-padding":""))),ce=_(()=>{const l=p.lang.rtl===!0?e.side:C.value;return[[Me,b,void 0,{[l]:!0,mouse:!0}]]}),V=_(()=>{const l=p.lang.rtl===!0?C.value:e.side;return[[Me,O,void 0,{[l]:!0,mouse:!0}]]}),Ie=_(()=>{const l=p.lang.rtl===!0?C.value:e.side;return[[Me,O,void 0,{[l]:!0,mouse:!0,mouseAllDir:!0}]]});function se(){ot(m,e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint)}F(m,l=>{l===!0?(z=u.value,u.value===!0&&oe(!1)):e.overlay===!1&&e.behavior!=="mobile"&&z!==!1&&(u.value===!0?(R(0),Z(0),pe()):he(!1))}),F(()=>e.side,(l,k)=>{i.instances[k]===ie&&(i.instances[k]=void 0,i[k].space=!1,i[k].offset=0),i.instances[l]=ie,i[l].size=E.value,i[l].space=ee.value,i[l].offset=Y.value}),F(i.totalWidth,()=>{(i.isContainer.value===!0||document.qScrollPrevented!==!0)&&se()}),F(()=>e.behavior+e.breakpoint,se),F(i.isContainer,l=>{u.value===!0&&P(l!==!0),l===!0&&se()}),F(i.scrollbarWidth,()=>{R(u.value===!0?0:void 0)}),F(Y,l=>{le("offset",l)}),F(ee,l=>{s("onLayout",l),le("space",l)}),F(H,()=>{R()}),F(E,l=>{R(),Ne(e.miniToOverlay,l)}),F(()=>e.miniToOverlay,l=>{Ne(l,E.value)}),F(()=>p.lang.rtl,()=>{R()}),F(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(de(),i.animate())}),F(W,l=>{s("miniState",l)});function R(l){l===void 0?Oe(()=>{l=u.value===!0?0:E.value,R(j.value*l)}):(i.isContainer.value===!0&&H.value===!0&&(m.value===!0||Math.abs(l)===E.value)&&(l+=j.value*i.scrollbarWidth.value),$.value=l)}function Z(l){_e.value=l}function ye(l){const k=l===!0?"remove":i.isContainer.value!==!0?"add":"";k!==""&&document.body.classList[k]("q-body--drawer-toggle")}function de(){g!==null&&clearTimeout(g),A.proxy&&A.proxy.$el&&A.proxy.$el.classList.add("q-drawer--mini-animate"),y.value=!0,g=setTimeout(()=>{g=null,y.value=!1,A&&A.proxy&&A.proxy.$el&&A.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function b(l){if(u.value!==!1)return;const k=E.value,G=qe(l.distance.x,0,k);if(l.isFinal===!0){G>=Math.min(75,k)===!0?he():(i.animate(),Z(0),R(j.value*k)),n.value=!1;return}R((p.lang.rtl===!0?H.value!==!0:H.value)?Math.max(k-G,0):Math.min(0,G-k)),Z(qe(G/k,0,1)),l.isFirst===!0&&(n.value=!0)}function O(l){if(u.value!==!0)return;const k=E.value,G=l.direction===e.side,Ae=(p.lang.rtl===!0?G!==!0:G)?qe(l.distance.x,0,k):0;if(l.isFinal===!0){Math.abs(Ae)<Math.min(75,k)===!0?(i.animate(),Z(1),R(0)):oe(),n.value=!1;return}R(j.value*Ae),Z(qe(1-Ae/k,0,1)),l.isFirst===!0&&(n.value=!0)}function pe(){P(!1),ye(!0)}function le(l,k){i.update(e.side,l,k)}function ot(l,k){l.value!==k&&(l.value=k)}function Ne(l,k){le("size",l===!0?e.miniWidth:k)}return i.instances[e.side]=ie,Ne(e.miniToOverlay,E.value),le("space",ee.value),le("offset",Y.value),e.showIfAbove===!0&&e.modelValue!==!0&&u.value===!0&&e["onUpdate:modelValue"]!==void 0&&s("update:modelValue",!0),Ce(()=>{s("onLayout",ee.value),s("miniState",W.value),z=e.showIfAbove===!0;const l=()=>{(u.value===!0?ne:be)(!1,!0)};if(i.totalWidth.value!==0){Oe(l);return}Q=F(i.totalWidth,()=>{Q(),Q=void 0,u.value===!1&&e.showIfAbove===!0&&m.value===!1?he(!1):l()})}),ht(()=>{Q!==void 0&&Q(),g!==null&&(clearTimeout(g),g=null),u.value===!0&&pe(),i.instances[e.side]===ie&&(i.instances[e.side]=void 0,le("size",0),le("offset",0),le("space",!1))}),()=>{const l=[];m.value===!0&&(e.noSwipeOpen===!1&&l.push(Ze(B("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),ce.value)),l.push(We("div",{ref:"backdrop",class:Ke.value,style:a.value,"aria-hidden":"true",onClick:oe},void 0,"backdrop",e.noSwipeBackdrop!==!0&&u.value===!0,()=>Ie.value)));const k=W.value===!0&&T.mini!==void 0,G=[B("div",{...N,key:""+k,class:[w.value,N.class]},k===!0?T.mini():ze(T.default))];return e.elevated===!0&&u.value===!0&&G.push(B("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(We("aside",{ref:"content",class:M.value,style:o.value},G,"contentclose",e.noSwipeClose!==!0&&m.value===!0,()=>V.value)),B("div",{class:"q-drawer-container"},l)}}});const nt={__name:"DynamicFormItem",props:{btnLabel:String,icon:String,url:String},setup(e){const T=e;Le();const s=I("AccessToken"),N=I("SessionToken");return(A,p)=>(S(),K(Te,{clickable:"",dark:"",onClick:p[0]||(p[0]=h=>x(Kt)(e.url,{AccessToken:x(s),SessionToken:x(N)}))},{default:c(()=>[d(ae,{avatar:""},{default:c(()=>[d($e,null,{default:c(()=>[d(lt,{src:e.icon},null,8,["src"])]),_:1})]),_:1}),d(ae,null,{default:c(()=>[d(te,{caption:""},{default:c(()=>[U("\u0412\u043E\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437")]),_:1}),d(te,null,{default:c(()=>[U(ke(T.btnLabel),1)]),_:1})]),_:1})]),_:1}))}},Vt={key:0,style:{width:"40px"}},it={__name:"AccountSelector",emits:["onSelectAccount"],setup(e,{emit:T}){Le();const s=String("https://auth.symphograph.ru/"),N=I("ServerGroupList"),A=I("AccountList");function p(){return A.value.filter(z=>z.authType!=="deefault")}const h=I("curAccount");L({id:1,nickName:"\u041D\u0435 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D",avatar:"init_ava.png",grade:1,serverId:9});const P=I("authTypes"),q=L(null),f=I("reLogin");function i(z){return N.value.find(g=>g.id===z)}return Ce(()=>{console.log(p())}),(z,g)=>{var Q,m,W,E;return(Q=p())!=null&&Q.length?(S(),K(at,{key:0,modelValue:x(h),"onUpdate:modelValue":[g[0]||(g[0]=u=>De(h)?h.value=u:null),g[1]||(g[1]=u=>x(f)(x(h).id,x(h).authType))],style:{"min-width":"16em"},ref_key:"selector",ref:q,dark:"","label-color":"grey",filled:"",label:(E=(W=(m=x(h))==null?void 0:m.settings)==null?void 0:W.publicNick)!=null?E:"dsd",options:p(),"option-value":"id","map-options":"","option-label":"nickName"},mt({"before-options":c(()=>[d(Te,{clickable:"",to:"/accounts"},{default:c(()=>[d(ae,{avatar:""},{default:c(()=>[d($e,{icon:"ionicon person outline"})]),_:1}),d(ae,null,{default:c(()=>[d(te,{caption:"",class:"text-grey"},{default:c(()=>[U("\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430\u043C\u0438")]),_:1}),d(te,null,{default:c(()=>[U("\u041F\u0440\u043E\u0444\u0438\u043B\u044C")]),_:1})]),_:1})]),_:1})]),option:c(u=>[u.opt.id!==x(h).id&&u.opt.authType!=="default"?(S(),K(Te,tt(Ee({key:0},u.itemProps)),{default:c(()=>[d(ae,{avatar:""},{default:c(()=>[d(Ve,{locIcon:x(s)+u.opt.Avatar.src,grade:1,size:"70px"},null,8,["locIcon"])]),_:2},1024),d(ae,null,{default:c(()=>[d(te,{caption:"",class:"text-grey-9"},{default:c(()=>[U(" \u0412\u043E\u0439\u0442\u0438 \u043A\u0430\u043A "),d(Be,{name:"img:/img/auth/"+u.opt.authType+".svg"},null,8,["name"])]),_:2},1024),d(te,null,{default:c(()=>[U(ke(u.opt.nickName),1)]),_:2},1024),d(te,{caption:"",class:"text-grey-6"},{default:c(()=>{var D,ne;return[U(ke((ne=(D=u.opt.settings)==null?void 0:D.publicNick)!=null?ne:""),1)]}),_:2},1024),d(te,{caption:"",class:"text-grey-9"},{default:c(()=>{var D;return[U(ke(i((D=u.opt.settings)==null?void 0:D.serverGroupId).label),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)):X("",!0)]),"after-options":c(()=>[(S(!0),fe(xe,null,Fe(x(P),u=>(S(),fe("div",{key:u.id},[d(nt,{btnLabel:u.label,icon:u.img,url:x(s)+u.url},null,8,["btnLabel","icon","url"])]))),128))]),_:2},[x(h)?{name:"append",fn:c(()=>[x(h).Avatar?(S(),fe("div",Vt,[d(Ve,{locIcon:x(s)+x(h).Avatar.src,grade:x(h).settings.grade},null,8,["locIcon","grade"])])):X("",!0)]),key:"0"}:void 0]),1032,["modelValue","label","options"])):X("",!0)}}},rt={__name:"LoginList",setup(e){const T=String("https://auth.symphograph.ru/"),s=I("authTypes");I("AccessToken"),I("SessionToken");const N=L(null);return(A,p)=>(S(),K(at,{modelValue:N.value,"onUpdate:modelValue":p[0]||(p[0]=h=>N.value=h),options:x(s),"map-options":"",label:"\u0412\u043E\u0439\u0442\u0438",style:{"min-width":"16em"},ref:"selector",dark:"",filled:"","option-value":"id","label-color":"grey"},{option:c(h=>[ve("div",tt(yt(h.itemProps)),[d(nt,{btnLabel:h.opt.label,icon:h.opt.img,url:x(T)+h.opt.url},null,8,["btnLabel","icon","url"])],16)]),_:1},8,["modelValue","options"]))}},Je={__name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""},ava:{type:String,default:""},children:{type:Array,default:()=>[]}},setup(e){return(T,s)=>(S(),K(Te,{clickable:"",tag:"a",to:e.link,dark:""},{default:c(()=>[e.icon||e.ava?(S(),K(ae,{key:0,avatar:""},{default:c(()=>[e.icon?(S(),K(Be,{key:0,name:e.icon},null,8,["name"])):X("",!0),e.ava?(S(),K($e,{key:1},{default:c(()=>[d(lt,{src:e.ava,ratio:30/30},null,8,["src"])]),_:1})):X("",!0)]),_:1})):X("",!0),d(ae,null,{default:c(()=>[d(te,null,{default:c(()=>[U(ke(e.title),1)]),_:1}),d(te,{caption:""},{default:c(()=>[U(ke(e.caption),1)]),_:1})]),_:1})]),_:1},8,["to"]))}},zt=["none","strict","leaf","leaf-filtered"];var Ut=Qe({name:"QTree",props:{...Xe,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>zt.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:T,emit:s}){const{proxy:N}=et(),{$q:A}=N,p=Ye(e,A),h=L({}),P=L(e.ticked||[]),q=L(e.expanded||[]);let f={};kt(()=>{f={}});const i=_(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(p.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),z=_(()=>e.selected!==void 0),g=_(()=>e.icon||A.iconSet.tree.icon),Q=_(()=>e.controlColor||e.color),m=_(()=>e.textColor!==void 0?` text-${e.textColor}`:""),W=_(()=>{const a=e.selectedColor||e.color;return a?` text-${a}`:""}),E=_(()=>e.filterMethod!==void 0?e.filterMethod:(a,r)=>{const t=r.toLowerCase();return a[e.labelKey]&&a[e.labelKey].toLowerCase().indexOf(t)>-1}),u=_(()=>{const a={},r=(t,v)=>{const o=t.tickStrategy||(v?v.tickStrategy:e.tickStrategy),w=t[e.nodeKey],M=t[e.childrenKey]&&Array.isArray(t[e.childrenKey])&&t[e.childrenKey].length!==0,ce=t.disabled!==!0&&z.value===!0&&t.selectable!==!1,V=t.disabled!==!0&&t.expandable!==!1,Ie=o!=="none",se=o==="strict",R=o==="leaf-filtered",Z=o==="leaf"||o==="leaf-filtered";let ye=t.disabled!==!0&&t.tickable!==!1;Z===!0&&ye===!0&&v&&v.tickable!==!0&&(ye=!1);let de=t.lazy;de===!0&&h.value[w]!==void 0&&Array.isArray(t[e.childrenKey])===!0&&(de=h.value[w]);const b={key:w,parent:v,isParent:M,lazy:de,disabled:t.disabled,link:t.disabled!==!0&&(ce===!0||V===!0&&(M===!0||de===!0)),children:[],matchesFilter:e.filter?E.value(t,e.filter):!0,selected:w===e.selected&&ce===!0,selectable:ce,expanded:M===!0?q.value.includes(w):!1,expandable:V,noTick:t.noTick===!0||se!==!0&&de&&de!=="loaded",tickable:ye,tickStrategy:o,hasTicking:Ie,strictTicking:se,leafFilteredTicking:R,leafTicking:Z,ticked:se===!0?P.value.includes(w):M===!0?!1:P.value.includes(w)};if(a[w]=b,M===!0&&(b.children=t[e.childrenKey].map(O=>r(O,b)),e.filter&&(b.matchesFilter!==!0?b.matchesFilter=b.children.some(O=>O.matchesFilter):b.noTick!==!0&&b.disabled!==!0&&b.tickable===!0&&R===!0&&b.children.every(O=>O.matchesFilter!==!0||O.noTick===!0||O.tickable!==!0)===!0&&(b.tickable=!1)),b.matchesFilter===!0&&(b.noTick!==!0&&se!==!0&&b.children.every(O=>O.noTick)===!0&&(b.noTick=!0),Z))){if(b.ticked=!1,b.indeterminate=b.children.some(O=>O.indeterminate===!0),b.tickable=b.tickable===!0&&b.children.some(O=>O.tickable),b.indeterminate!==!0){const O=b.children.reduce((pe,le)=>le.ticked===!0?pe+1:pe,0);O===b.children.length?b.ticked=!0:O>0&&(b.indeterminate=!0)}b.indeterminate===!0&&(b.indeterminateNextState=b.children.every(O=>O.tickable!==!0||O.ticked!==!0))}return b};return e.nodes.forEach(t=>r(t,null)),a});F(()=>e.ticked,a=>{P.value=a}),F(()=>e.expanded,a=>{q.value=a});function D(a){const r=[].reduce,t=(v,o)=>{if(v||!o)return v;if(Array.isArray(o)===!0)return r.call(Object(o),t,v);if(o[e.nodeKey]===a)return o;if(o[e.childrenKey])return t(null,o[e.childrenKey])};return t(null,e.nodes)}function ne(){return P.value.map(a=>D(a))}function be(){return q.value.map(a=>D(a))}function he(a){return a&&u.value[a]?u.value[a].expanded:!1}function oe(){e.expanded!==void 0?s("update:expanded",[]):q.value=[]}function ge(){const a=[],r=t=>{t[e.childrenKey]&&t[e.childrenKey].length!==0&&t.expandable!==!1&&t.disabled!==!0&&(a.push(t[e.nodeKey]),t[e.childrenKey].forEach(r))};e.nodes.forEach(r),e.expanded!==void 0?s("update:expanded",a):q.value=a}function me(a,r,t=D(a),v=u.value[a]){if(v.lazy&&v.lazy!=="loaded"){if(v.lazy==="loading")return;h.value[a]="loading",Array.isArray(t[e.childrenKey])!==!0&&(t[e.childrenKey]=[]),s("lazyLoad",{node:t,key:a,done:o=>{h.value[a]="loaded",t[e.childrenKey]=Array.isArray(o)===!0?o:[],Oe(()=>{const w=u.value[a];w&&w.isParent===!0&&ie(a,!0)})},fail:()=>{delete h.value[a],t[e.childrenKey].length===0&&delete t[e.childrenKey]}})}else v.isParent===!0&&v.expandable===!0&&ie(a,r)}function ie(a,r){let t=q.value;const v=e.expanded!==void 0;if(v===!0&&(t=t.slice()),r){if(e.accordion&&u.value[a]){const o=[];u.value[a].parent?u.value[a].parent.children.forEach(w=>{w.key!==a&&w.expandable===!0&&o.push(w.key)}):e.nodes.forEach(w=>{const M=w[e.nodeKey];M!==a&&o.push(M)}),o.length!==0&&(t=t.filter(w=>o.includes(w)===!1))}t=t.concat([a]).filter((o,w,M)=>M.indexOf(o)===w)}else t=t.filter(o=>o!==a);v===!0?s("update:expanded",t):q.value=t}function H(a){return a&&u.value[a]?u.value[a].ticked:!1}function j(a,r){let t=P.value;const v=e.ticked!==void 0;v===!0&&(t=t.slice()),r?t=t.concat(a).filter((o,w,M)=>M.indexOf(o)===w):t=t.filter(o=>a.includes(o)===!1),v===!0&&s("update:ticked",t)}function _e(a,r,t){const v={tree:N,node:a,key:t,color:e.color,dark:p.value};return Ge(v,"expanded",()=>r.expanded,o=>{o!==r.expanded&&me(t,o)}),Ge(v,"ticked",()=>r.ticked,o=>{o!==r.ticked&&j([t],o)}),v}function n(a){return(e.filter?a.filter(r=>u.value[r[e.nodeKey]].matchesFilter):a).map(r=>Y(r))}function y(a){if(a.icon!==void 0)return B(Be,{class:"q-tree__icon q-mr-sm",name:a.icon,color:a.iconColor});const r=a.img||a.avatar;if(r)return B("img",{class:`q-tree__${a.img?"img":"avatar"} q-mr-sm`,src:r})}function $(){s("afterShow")}function C(){s("afterHide")}function Y(a){const r=a[e.nodeKey],t=u.value[r],v=a.header&&T[`header-${a.header}`]||T["default-header"],o=t.isParent===!0?n(a[e.childrenKey]):[],w=o.length!==0||t.lazy&&t.lazy!=="loaded";let M=a.body&&T[`body-${a.body}`]||T["default-body"];const ce=v!==void 0||M!==void 0?_e(a,t,r):null;return M!==void 0&&(M=B("div",{class:"q-tree__node-body relative-position"},[B("div",{class:m.value},[M(ce)])])),B("div",{key:r,class:`q-tree__node relative-position q-tree__node--${w===!0?"parent":"child"}`},[B("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(t.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(t.selected===!0?" q-tree__node--selected":"")+(t.disabled===!0?" q-tree__node--disabled":""),tabindex:t.link===!0?0:-1,ariaExpanded:o.length>0?t.expanded:null,role:"treeitem",onClick:V=>{ee(a,t,V)},onKeypress(V){bt(V)!==!0&&(V.keyCode===13?ee(a,t,V,!0):V.keyCode===32&&ue(a,t,V,!0))}},[B("div",{class:"q-focus-helper",tabindex:-1,ref:V=>{f[t.key]=V}}),t.lazy==="loading"?B(_t,{class:"q-tree__spinner",color:Q.value}):w===!0?B(Be,{class:"q-tree__arrow"+(t.expanded===!0?" q-tree__arrow--rotate":""),name:g.value,onClick(V){ue(a,t,V)}}):null,t.hasTicking===!0&&t.noTick!==!0?B(pt,{class:"q-tree__tickbox",modelValue:t.indeterminate===!0?null:t.ticked,color:Q.value,dark:p.value,dense:!0,keepColor:!0,disable:t.tickable!==!0,onKeydown:Re,"onUpdate:modelValue":V=>{Ke(t,V)}}):null,B("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(t.selected===!0?W.value:m.value)},[v?v(ce):[y(a),B("div",a[e.labelKey])]])]),w===!0?e.noTransition===!0?t.expanded===!0?B("div",{class:"q-tree__node-collapsible"+m.value,key:`${r}__q`},[M,B("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]):null:B(Pt,{duration:e.duration,onShow:$,onHide:C},()=>Ze(B("div",{class:"q-tree__node-collapsible"+m.value,key:`${r}__q`},[M,B("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]),[[xt,t.expanded]])):M])}function re(a){const r=f[a];r&&r.focus()}function ee(a,r,t,v){v!==!0&&r.selectable!==!1&&re(r.key),z.value&&r.selectable?e.noSelectionUnset===!1?s("update:selected",r.key!==e.selected?r.key:null):r.key!==e.selected&&s("update:selected",r.key===void 0?null:r.key):ue(a,r,t,v),typeof a.handler=="function"&&a.handler(a)}function ue(a,r,t,v){t!==void 0&&Re(t),v!==!0&&r.selectable!==!1&&re(r.key),me(r.key,!r.expanded,a,r)}function Ke(a,r){if(a.indeterminate===!0&&(r=a.indeterminateNextState),a.strictTicking)j([a.key],r);else if(a.leafTicking){const t=[],v=o=>{o.isParent?(r!==!0&&o.noTick!==!0&&o.tickable===!0&&t.push(o.key),o.leafTicking===!0&&o.children.forEach(v)):o.noTick!==!0&&o.tickable===!0&&(o.leafFilteredTicking!==!0||o.matchesFilter===!0)&&t.push(o.key)};v(a),j(t,r)}}return e.defaultExpandAll===!0&&ge(),Object.assign(N,{getNodeByKey:D,getTickedNodes:ne,getExpandedNodes:be,isExpanded:he,collapseAll:oe,expandAll:ge,setExpanded:me,isTicked:H,setTicked:j}),()=>{const a=n(e.nodes);return B("div",{class:i.value,role:"tree"},a.length===0?e.filter?e.noResultsLabel||A.lang.tree.noResults:e.noNodesLabel||A.lang.tree.noNodes:a)}}});const Wt={__name:"CategoryTree",setup(e){const T=Le(),s=String("https://api.aa.dllib.ru/"),N=Ue(),A=St(),p=I("CategoriesList"),h=I("expandedCategNode"),P=I("selCategId"),q=I("selCategNode"),f=L(null);I("categMode"),F(P,()=>{if(!f.value)return;let g=f.value.getNodeByKey(P.value);if(g){let Q=f.value.getNodeByKey(g.parent);q.value=g,h.value=[Q.parent,g.parent]}else q.value=null},{deep:!0}),Ce(()=>{z()});function i(){N.path!=="/category"&&A.push({path:"/category"})}function z(){Se.post(s+"api/options.php",{params:{method:"getCategories"}}).then(g=>{var Q,m,W;if(!((Q=g==null?void 0:g.data)!=null&&Q.result))throw new Error;g.data.result&&(p.value=(W=(m=g==null?void 0:g.data)==null?void 0:m.data)!=null?W:[])}).catch(g=>{T.notify(we(g,"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u043D\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u043B\u0438\u0441\u044C"))})}return(g,Q)=>x(p)?(S(),K(Te,{key:0,separator:"",dark:""},{default:c(()=>[d(ae,null,{default:c(()=>[d(Ut,{dark:"",color:"gray","control-color":"black",ref_key:"tree",ref:f,accordion:"",nodes:x(p),"label-key":"name",expanded:x(h),"onUpdate:expanded":Q[0]||(Q[0]=m=>De(h)?h.value=m:null),selected:x(P),"onUpdate:selected":[Q[1]||(Q[1]=m=>De(P)?P.value=m:null),i],"no-transition":"","selected-color":"orange","node-key":"id",dense:""},null,8,["nodes","expanded","selected"])]),_:1})]),_:1})):X("",!0)}},Rt=["src"],Gt={__name:"DrawerContent",setup(e){const T=Ue(),s=Le(),N=I("AccountList"),A=[{title:"\u041F\u0430\u043A\u0438",caption:"\u0420\u0430\u0441\u043A\u0440\u044B\u0432\u0430\u0435\u043C\u044B\u0439",ava:"/img/pack.png",children:[{title:"\u041F\u0430\u043A\u0438",caption:"\u0422\u0430\u0431\u043B\u0438\u0446\u0430 \u043F\u0430\u043A\u043E\u0432",ava:"/img/pack.png",link:"/packs"},{title:"\u041F\u0430\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u041A\u0430\u043B\u044C\u043A\u0443\u043B\u044F\u0442\u043E\u0440 \u043F\u0430\u043A\u043E\u0432",ava:"/img/packmaker.png",link:"/packinfo"}]},{title:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B",caption:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0441\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438",ava:"/img/crafcul.png",children:[{title:"\u041A\u0440\u0430\u0444\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0441\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438",link:"/item/"},{title:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",caption:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B \u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",link:"/category"}]},{title:"\u041C\u043E\u0438 \u0446\u0435\u043D\u044B",caption:"\u0426\u0435\u043D\u044B \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u043E\u0432",ava:"/img/myprices.png",link:"/myprices/"},{title:"\u0421\u043E\u043E\u0431\u0449\u0435\u0441\u0442\u0432\u043E",caption:"\u0426\u0435\u043D\u044B \u0438\u0433\u0440\u043E\u043A\u043E\u0432",ava:"/img/community.png",link:"/members"},{title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",caption:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u0442\u0435 \u0441\u0432\u043E\u0438 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B",ava:"/img/settings.png",link:"/settings"}],p=I("ServerGroupList"),h=_(()=>!!T.path.match(/^\/item\//)||!!T.path.match(/^\/category/));return Ce(()=>{}),(P,q)=>(S(),fe(xe,null,[x(s).platform.is.mobile?(S(),fe(xe,{key:0},[x(N)&&x(N).some(f=>f.authType!=="default")?(S(),K(it,{key:0})):(S(),K(rt,{key:1}))],64)):X("",!0),d(Ot,{separator:""},{default:c(()=>[d(te,{header:""},{default:c(()=>[U(" Graph Tools ")]),_:1}),(S(),fe(xe,null,Fe(A,f=>(S(),fe(xe,{key:f.title},[(f==null?void 0:f.children)&&(f==null?void 0:f.children.length)?(S(),K(Mt,{key:0,"content-inset-level":.2,"expand-separator":"",label:f.title,caption:f.caption,"default-closed":""},{header:c(()=>[f!=null&&f.ava?(S(),K(ae,{key:0,avatar:""},{default:c(()=>[d($e,null,{default:c(()=>[ve("img",{src:f.ava},null,8,Rt)]),_:2},1024)]),_:2},1024)):X("",!0),d(ae,null,{default:c(()=>[U(ke(f.title),1)]),_:2},1024)]),default:c(()=>[(S(!0),fe(xe,null,Fe(f.children,i=>(S(),K(Je,Ee({key:i.title},i,{title:i.title}),null,16,["title"]))),128))]),_:2},1032,["label","caption"])):(S(),K(Je,Ee({key:f.title},f,{title:f.title}),null,16,["title"]))],64))),64)),h.value&&x(p).length?(S(),K(Wt,{key:0})):X("",!0)]),_:1})],64))}},Ht=ve("div",{style:{margin:"auto",color:"red"}},"* \u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u043A\u0435 *",-1),jt={class:"col"},Jt={class:"column full-height"},Xt=ve("div",{class:"footer"},[U("\xA9 "),ve("a",{href:"https://vk.com/roman_chubich",target:"_blank"},"\u0413\u0440\u0430\u0444"),U(" * "),ve("a",{href:"https://github.com/symphograph/ArcheAgeTools_Frontend",target:"_blank"},"Github"),U(" * \u0428\u0430\u0435\u0434\u0430 ")],-1),ba={__name:"MidLayout",emits:["reLogin"],setup(e,{emit:T}){const s=Le(),N=String("https://api.aa.dllib.ru/"),A=String("https://auth.symphograph.ru/"),p=Ue();I("progress");const h=I("AccessToken"),P=I("isOptionsLoaded");I("isTokenRefreshed"),I("isAccountsLoaded");const q=L([]);J("AccountList",q);const f=L({settings:{}});J("curAccount",f);const i=L({});J("AccSets",i);const z=L([]);J("AccSetList",z);const g=L([]);J("ServerGroupList",g);function Q(){let n=q.value.map(y=>{const $=z.value.find(C=>C.accountId===y.id);return $?{...y,settings:$}:y});q.value=n.sort((y,$)=>new Date($.visitedAt)-new Date(y.visitedAt))}const m=L(0);J("selCategId",m);const W=L(null);J("selCategNode",W);const E=L([]);J("ProfLvls",E);const u=L([{id:2,label:"\u0422\u0435\u043B\u0435\u0433\u0440\u0430\u043C",url:"auth/telegram/login.php",img:"/img/auth/telegram.svg"},{id:3,label:"MailRu",url:"auth/mailru/login.php",img:"/img/auth/mailru.svg"},{id:4,label:"Discord",url:"auth/discord/login.php",img:"/img/auth/discord.svg"},{id:4,label:"V\u041A\u043E\u043D\u0442\u0430\u043A\u0442\u0435",url:"auth/vkontakte/login.php",img:"/img/auth/vkontakte.svg"}]);J("authTypes",u);const D=L(!1),ne=L(null);J("CategoriesList",ne);const be=L([]);J("expandedCategNode",be);const he=L(!1);J("categMode",he),J("selectOptionsStyle",{backgroundColor:"rgb(181 238 8 / 93%)",color:"#4B3A23"});function ge(){D.value=!D.value}function me(){Se.post(N+"api/options.php",{params:{method:"getMain"}}).then(n=>{var y,$,C,Y,re,ee,ue;if(!((y=n==null?void 0:n.data)!=null&&y.result))throw new Error;g.value=(Y=(C=($=n==null?void 0:n.data)==null?void 0:$.data)==null?void 0:C.ServerGroupList)!=null?Y:[],E.value=(ue=(ee=(re=n==null?void 0:n.data)==null?void 0:re.data)==null?void 0:ee.ProfLvls)!=null?ue:[],H()}).catch(n=>{s.notify(we(n))})}function ie(){Se.post(A+"api/test.php",{params:{method:"get"}}).then(n=>{var y;if(!((y=n==null?void 0:n.data)!=null&&y.result))throw new Error;s.notify(Nt(n.data.result))}).catch(n=>{s.notify(we(n))})}function H(){Se.post(A+"api/account.php",{params:{method:"list"}}).then(n=>{var $,C;if(!(($=n==null?void 0:n.data)!=null&&$.result))throw new Error;let y=(C=n==null?void 0:n.data)==null?void 0:C.data;f.value=y.find(Y=>Y.id===It(h.value)),q.value=y.filter(Y=>Y.authType!=="default"),j()}).catch(n=>{s.notify(we(n))})}function j(){Se.post(N+"api/settings.php",{params:{method:"get"}}).then(n=>{var y,$,C;if(!((y=n==null?void 0:n.data)!=null&&y.result))throw new Error;i.value=($=n==null?void 0:n.data)==null?void 0:$.data,f.value.settings=(C=n==null?void 0:n.data)==null?void 0:C.data,_e()}).catch(n=>{s.notify(we(n))})}function _e(){Se.post(N+"api/settings.php",{params:{method:"list",ids:q.value.map(n=>n.id)}}).then(n=>{var y,$,C;if(!((y=n==null?void 0:n.data)!=null&&y.result))throw new Error;z.value=(C=($=n==null?void 0:n.data)==null?void 0:$.data)!=null?C:[],Q(),P.value=!0}).catch(n=>{s.notify(we(n))})}return F(p,n=>{$t.set("lastPath",n.path)}),wt(()=>{}),Ce(()=>{me()}),(n,y)=>{const $=Tt("router-view");return x(P)?(S(),K(Bt,{key:0,view:"lHh Lpr lFf"},{default:c(()=>[d(Lt,{elevated:""},{default:c(()=>[d(Ft,null,{default:c(()=>[d(He,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:ge}),d(Et,null,{default:c(()=>[U(" GraphTools ")]),_:1}),Ht,x(s).platform.is.desktop?(S(),K(Ct,{key:0,"inline-label":"",class:"bg-primary text-white shadow-2",align:"center"},{default:c(()=>[d(He,{label:"test",onClick:y[0]||(y[0]=C=>ie())}),q.value&&q.value.some(C=>C.authType!=="default")?(S(),K(it,{key:0,onOnSelectAccount:y[1]||(y[1]=C=>T("reLogin"))})):(S(),K(rt,{key:1}))]),_:1})):(S(),K(Ve,{key:1,locIcon:x(A)+f.value.Avatar.src,grade:i.value.grade,onClick:ge},null,8,["locIcon","grade"]))]),_:1})]),_:1}),d(Dt,{modelValue:D.value,"onUpdate:modelValue":y[2]||(y[2]=C=>D.value=C),"show-if-above":"",behavior:"default",bordered:"",dark:""},{default:c(()=>[d(Gt)]),_:1},8,["modelValue"]),f.value?(S(),K(Qt,{key:0},{default:c(()=>[d(qt,{class:"row no-wrap"},{default:c(()=>[ve("div",jt,[ve("div",Jt,[x(P)?(S(),K($,{key:0})):X("",!0)])])]),_:1})]),_:1})):X("",!0),d(At,null,{default:c(()=>[Xt]),_:1})]),_:1})):X("",!0)}}};export{ba as default};
