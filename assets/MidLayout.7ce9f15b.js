import{Q as ct}from"./QPage.2c6d2742.js";import{Q as dt,a as ft}from"./QLayout.a48ab7b0.js";import{Q as vt,a as ht}from"./QHeader.8061dab4.js";import{api as Ce}from"./axios.c7c3d222.js";import{P as gt}from"./LocalStorage.dd197208.js";import{u as Se}from"./use-quasar.df17c2ed.js";import{Q as ee,a as Z,b as xe}from"./position-engine.fcb91d72.js";import{n as w,t as P,G as u,f as s,Q as Be,H as U,I as ve,J as k,i as z,r as $,c as p,o as Te,K as mt,q as re,l as X,L as Ze,M as Oe,N as $e,F as ye,O as Ee,b as Fe,P as fe,R as yt,S as Qe,U as et,V as tt,W as kt,w as D,h as K,g as at,X as De,Y as bt,Z as _t,_ as pt,$ as Re,a0 as lt,a1 as xt,a2 as He,u as Ge,a3 as St,a4 as We,a5 as wt,a6 as Ct,a7 as Lt,a8 as Ne,a9 as Tt,aa as At,ab as qt,ac as je,ad as $t,ae as Bt,d as Qt,af as Xe,p as j,k as It,m as Kt}from"./index.cf591b40.js";import{Q as nt}from"./QSelect.85e4a152.js";import{I as Ve}from"./ItemIcon.ccf8782e.js";import{Q as it}from"./QImg.78289a08.js";import{d as Mt,n as Le}from"./myFuncts.7b3aa3f0.js";import{m as ze,a as Ue}from"./myAuth.8a31f6b7.js";import{Q as Nt,a as Pt}from"./QExpansionItem.b1bf63f1.js";import{Q as Ot}from"./QList.c381a4c6.js";import{Q as Et}from"./QTabs.b92369b3.js";import{T as Pe}from"./TouchPan.dc0265e9.js";import{b as qe}from"./format.959830d0.js";import"./QScrollObserver.42abb11c.js";import"./selection.cc14137b.js";import"./QMenu.5a066f52.js";import"./plugin-vue_export-helper.21dcd24c.js";const rt={__name:"DynamicFormItem",props:{btnLabel:String,icon:String,url:String},setup(e){Se();const C=e;return(f,A)=>(w(),P(xe,{clickable:"",dark:"",onClick:A[0]||(A[0]=B=>k(Mt)(e.url,{AccessToken:k(ze).self.AccessToken,SessionToken:k(ze).self.SessionToken}))},{default:u(()=>[s(ee,{avatar:""},{default:u(()=>[s(Be,null,{default:u(()=>[s(it,{src:e.icon},null,8,["src"])]),_:1})]),_:1}),s(ee,null,{default:u(()=>[s(Z,{caption:""},{default:u(()=>A[1]||(A[1]=[U("\u0412\u043E\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437")])),_:1}),s(Z,null,{default:u(()=>[U(ve(C.btnLabel),1)]),_:1})]),_:1})]),_:1}))}},Ft={key:0,style:{width:"40px"}},ot={__name:"AccountSelector",emits:["onSelectAccount"],setup(e,{emit:C}){Se();const f=String("https://auth.symphograph.ru/"),A=z("ServerGroupList"),B=z("AccountList");function x(){return B.value.filter(c=>c.authType!=="deefault")}const d=z("curAccount");$({id:1,nickName:"\u041D\u0435 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D",avatar:"init_ava.png",grade:1,serverId:9});const M=z("authTypes"),q=$(null),v=z("reLogin");function i(c){return A.value.find(m=>m.id===c)}const Q=p(()=>{var m,y;const c=i((y=(m=d.value)==null?void 0:m.settings)==null?void 0:y.serverGroupId);return c||null});return Te(()=>{}),(c,m)=>{var y,G,F,g;return(y=x())!=null&&y.length?(w(),P(nt,{key:0,modelValue:k(d),"onUpdate:modelValue":[m[0]||(m[0]=L=>Fe(d)?d.value=L:null),m[1]||(m[1]=L=>k(v)(k(d).id,k(d).authType))],style:{"min-width":"16em"},ref_key:"selector",ref:q,dark:"","label-color":"grey",filled:"",label:`${(g=(F=(G=k(d))==null?void 0:G.settings)==null?void 0:F.publicNick)!=null?g:"dsd"}`,options:x(),"option-value":"id","map-options":"","option-label":"nickName"},mt({selected:u(()=>[s(xe,{dark:"",dense:""},{default:u(()=>[s(ee,null,{default:u(()=>[s(Z,{caption:""},{default:u(()=>{var L;return[U(ve((L=Q.value)==null?void 0:L.label),1)]}),_:1})]),_:1})]),_:1})]),"before-options":u(()=>[s(xe,{clickable:"",to:"/accounts"},{default:u(()=>[s(ee,{avatar:""},{default:u(()=>[s(Be,{icon:"ionicon person outline"})]),_:1}),s(ee,null,{default:u(()=>[s(Z,{caption:"",class:"text-grey"},{default:u(()=>m[2]||(m[2]=[U("\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430\u043C\u0438")])),_:1}),s(Z,null,{default:u(()=>m[3]||(m[3]=[U("\u041F\u0440\u043E\u0444\u0438\u043B\u044C")])),_:1})]),_:1})]),_:1})]),option:u(L=>[L.opt.id!==k(d).id&&L.opt.authType!=="default"?(w(),P(xe,Ze(Oe({key:0},L.itemProps)),{default:u(()=>[s(ee,{avatar:""},{default:u(()=>{var W;return[s(Ve,{locIcon:k(f)+((W=L.opt.Avatar)==null?void 0:W.src),grade:1,size:"70px"},null,8,["locIcon"])]}),_:2},1024),s(ee,null,{default:u(()=>[s(Z,{caption:"",class:"text-grey-9"},{default:u(()=>[m[4]||(m[4]=U(" \u0412\u043E\u0439\u0442\u0438 \u043A\u0430\u043A ")),s($e,{name:"img:/img/auth/"+L.opt.authType+".svg"},null,8,["name"])]),_:2},1024),s(Z,null,{default:u(()=>[U(ve(L.opt.nickName),1)]),_:2},1024),s(Z,{caption:"",class:"text-grey-6"},{default:u(()=>{var W,ae;return[U(ve((ae=(W=L.opt.settings)==null?void 0:W.publicNick)!=null?ae:""),1)]}),_:2},1024),s(Z,{caption:"",class:"text-grey-9"},{default:u(()=>{var W;return[U(ve(i((W=L.opt.settings)==null?void 0:W.serverGroupId).label),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)):X("",!0)]),"after-options":u(()=>[(w(!0),re(ye,null,Ee(k(M),L=>(w(),re("div",{key:L.id},[s(rt,{btnLabel:L.label,icon:L.img,url:k(f)+L.url},null,8,["btnLabel","icon","url"])]))),128))]),_:2},[k(d)?{name:"append",fn:u(()=>[k(d).Avatar?(w(),re("div",Ft,[s(Ve,{locIcon:k(f)+k(d).Avatar.src,grade:k(d).settings.grade},null,8,["locIcon","grade"])])):X("",!0)]),key:"0"}:void 0]),1032,["modelValue","label","options"])):X("",!0)}}},ut={__name:"LoginList",setup(e){const C=String("https://auth.symphograph.ru/"),f=z("authTypes"),A=$(null);return(B,x)=>(w(),P(nt,{modelValue:A.value,"onUpdate:modelValue":x[0]||(x[0]=d=>A.value=d),options:k(f),"map-options":"",label:"\u0412\u043E\u0439\u0442\u0438",style:{"min-width":"16em"},ref:"selector",dark:"",filled:"","option-value":"id","label-color":"grey"},{option:u(d=>[fe("div",Ze(yt(d.itemProps)),[s(rt,{btnLabel:d.opt.label,icon:d.opt.img,url:k(C)+d.opt.url},null,8,["btnLabel","icon","url"])],16)]),_:1},8,["modelValue","options"]))}},Je={__name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""},ava:{type:String,default:""},children:{type:Array,default:()=>[]}},setup(e){return(C,f)=>(w(),P(xe,{clickable:"",tag:"a",to:e.link,dark:""},{default:u(()=>[e.icon||e.ava?(w(),P(ee,{key:0,avatar:""},{default:u(()=>[e.icon?(w(),P($e,{key:0,name:e.icon},null,8,["name"])):X("",!0),e.ava?(w(),P(Be,{key:1},{default:u(()=>[s(it,{src:e.ava,ratio:30/30},null,8,["src"])]),_:1})):X("",!0)]),_:1})):X("",!0),s(ee,null,{default:u(()=>[s(Z,null,{default:u(()=>[U(ve(e.title),1)]),_:1}),s(Z,{caption:""},{default:u(()=>[U(ve(e.caption),1)]),_:1})]),_:1})]),_:1},8,["to"]))}},Dt=["none","strict","leaf","leaf-filtered"];var Vt=Qe({name:"QTree",props:{...et,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>Dt.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:{},noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:C,emit:f}){const{proxy:A}=at(),{$q:B}=A,x=tt(e,B),d=$({}),M=$(e.ticked||[]),q=$(e.expanded||[]);let v={};kt(()=>{v={}});const i=p(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(x.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),Q=p(()=>e.selected!==void 0),c=p(()=>e.icon||B.iconSet.tree.icon),m=p(()=>e.controlColor||e.color),y=p(()=>e.textColor!==void 0?` text-${e.textColor}`:""),G=p(()=>{const a=e.selectedColor||e.color;return a?` text-${a}`:""}),F=p(()=>e.filterMethod!==void 0?e.filterMethod:(a,r)=>{const t=r.toLowerCase();return a[e.labelKey]&&a[e.labelKey].toLowerCase().indexOf(t)!==-1}),g=p(()=>{const a={},r=(t,h)=>{const o=t.tickStrategy||(h?h.tickStrategy:e.tickStrategy),T=t[e.nodeKey],O=t[e.childrenKey]&&Array.isArray(t[e.childrenKey])&&t[e.childrenKey].length!==0,se=t.disabled!==!0&&Q.value===!0&&t.selectable!==!1,V=t.disabled!==!0&&t.expandable!==!1,Ke=o!=="none",ce=o==="strict",R=o==="leaf-filtered",Y=o==="leaf"||o==="leaf-filtered";let me=t.disabled!==!0&&t.tickable!==!1;Y===!0&&me===!0&&h&&h.tickable!==!0&&(me=!1);let de=t.lazy;de===!0&&d.value[T]!==void 0&&Array.isArray(t[e.childrenKey])===!0&&(de=d.value[T]);const S={key:T,parent:h,isParent:O,lazy:de,disabled:t.disabled,link:t.disabled!==!0&&(se===!0||V===!0&&(O===!0||de===!0)),children:[],matchesFilter:e.filter?F.value(t,e.filter):!0,selected:T===e.selected&&se===!0,selectable:se,expanded:O===!0?q.value.includes(T):!1,expandable:V,noTick:t.noTick===!0||ce!==!0&&de&&de!=="loaded",tickable:me,tickStrategy:o,hasTicking:Ke,strictTicking:ce,leafFilteredTicking:R,leafTicking:Y,ticked:ce===!0?M.value.includes(T):O===!0?!1:M.value.includes(T)};if(a[T]=S,O===!0&&(S.children=t[e.childrenKey].map(E=>r(E,S)),e.filter&&(S.matchesFilter!==!0?S.matchesFilter=S.children.some(E=>E.matchesFilter):S.noTick!==!0&&S.disabled!==!0&&S.tickable===!0&&R===!0&&S.children.every(E=>E.matchesFilter!==!0||E.noTick===!0||E.tickable!==!0)===!0&&(S.tickable=!1)),S.matchesFilter===!0&&(S.noTick!==!0&&ce!==!0&&S.children.every(E=>E.noTick)===!0&&(S.noTick=!0),Y))){if(S.ticked=!1,S.indeterminate=S.children.some(E=>E.indeterminate===!0),S.tickable=S.tickable===!0&&S.children.some(E=>E.tickable),S.indeterminate!==!0){const E=S.children.reduce((pe,te)=>te.ticked===!0?pe+1:pe,0);E===S.children.length?S.ticked=!0:E>0&&(S.indeterminate=!0)}S.indeterminate===!0&&(S.indeterminateNextState=S.children.every(E=>E.tickable!==!0||E.ticked!==!0))}return S};return e.nodes.forEach(t=>r(t,null)),a});D(()=>e.ticked,a=>{M.value=a}),D(()=>e.expanded,a=>{q.value=a});function L(a){const r=[].reduce,t=(h,o)=>{if(h||!o)return h;if(Array.isArray(o)===!0)return r.call(Object(o),t,h);if(o[e.nodeKey]===a)return o;if(o[e.childrenKey])return t(null,o[e.childrenKey])};return t(null,e.nodes)}function W(){return M.value.map(a=>L(a))}function ae(){return q.value.map(a=>L(a))}function ke(a){return a&&g.value[a]?g.value[a].expanded:!1}function le(){e.expanded!==void 0?f("update:expanded",[]):q.value=[]}function be(){const a=[],r=t=>{t[e.childrenKey]&&t[e.childrenKey].length!==0&&t.expandable!==!1&&t.disabled!==!0&&(a.push(t[e.nodeKey]),t[e.childrenKey].forEach(r))};e.nodes.forEach(r),e.expanded!==void 0?f("update:expanded",a):q.value=a}function he(a,r,t=L(a),h=g.value[a]){if(h.lazy&&h.lazy!=="loaded"){if(h.lazy==="loading")return;d.value[a]="loading",Array.isArray(t[e.childrenKey])!==!0&&(t[e.childrenKey]=[]),f("lazyLoad",{node:t,key:a,done:o=>{d.value[a]="loaded",t[e.childrenKey]=Array.isArray(o)===!0?o:[],De(()=>{const T=g.value[a];T&&T.isParent===!0&&ne(a,!0)})},fail:()=>{delete d.value[a],t[e.childrenKey].length===0&&delete t[e.childrenKey]}})}else h.isParent===!0&&h.expandable===!0&&ne(a,r)}function ne(a,r){let t=q.value;const h=e.expanded!==void 0;if(h===!0&&(t=t.slice()),r){if(e.accordion&&g.value[a]){const o=[];g.value[a].parent?g.value[a].parent.children.forEach(T=>{T.key!==a&&T.expandable===!0&&o.push(T.key)}):e.nodes.forEach(T=>{const O=T[e.nodeKey];O!==a&&o.push(O)}),o.length!==0&&(t=t.filter(T=>o.includes(T)===!1))}t=t.concat([a]).filter((o,T,O)=>O.indexOf(o)===T)}else t=t.filter(o=>o!==a);h===!0?f("update:expanded",t):q.value=t}function n(a){return a&&g.value[a]?g.value[a].ticked:!1}function b(a,r){let t=M.value;const h=e.ticked!==void 0;h===!0&&(t=t.slice()),r?t=t.concat(a).filter((o,T,O)=>O.indexOf(o)===T):t=t.filter(o=>a.includes(o)===!1),h===!0&&f("update:ticked",t)}function N(a,r,t){const h={tree:A,node:a,key:t,color:e.color,dark:x.value};return He(h,"expanded",()=>r.expanded,o=>{o!==r.expanded&&he(t,o)}),He(h,"ticked",()=>r.ticked,o=>{o!==r.ticked&&b([t],o)}),h}function I(a){return(e.filter?a.filter(r=>g.value[r[e.nodeKey]].matchesFilter):a).map(r=>oe(r))}function J(a){if(a.icon!==void 0)return K($e,{class:"q-tree__icon q-mr-sm",name:a.icon,color:a.iconColor});const r=a.img||a.avatar;if(r)return K("img",{class:`q-tree__${a.img?"img":"avatar"} q-mr-sm`,src:r})}function ge(){f("afterShow")}function ie(){f("afterHide")}function oe(a){const r=a[e.nodeKey],t=g.value[r],h=a.header&&C[`header-${a.header}`]||C["default-header"],o=t.isParent===!0?I(a[e.childrenKey]):[],T=o.length!==0||t.lazy&&t.lazy!=="loaded";let O=a.body&&C[`body-${a.body}`]||C["default-body"];const se=h!==void 0||O!==void 0?N(a,t,r):null;return O!==void 0&&(O=K("div",{class:"q-tree__node-body relative-position"},[K("div",{class:y.value},[O(se)])])),K("div",{key:r,class:`q-tree__node relative-position q-tree__node--${T===!0?"parent":"child"}`},[K("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(t.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(t.selected===!0?" q-tree__node--selected":"")+(t.disabled===!0?" q-tree__node--disabled":""),tabindex:t.link===!0?0:-1,ariaExpanded:o.length>0?t.expanded:null,role:"treeitem",onClick:V=>{ue(a,t,V)},onKeypress(V){bt(V)!==!0&&(V.keyCode===13?ue(a,t,V,!0):V.keyCode===32&&we(a,t,V,!0))}},[K("div",{class:"q-focus-helper",tabindex:-1,ref:V=>{v[t.key]=V}}),t.lazy==="loading"?K(_t,{class:"q-tree__spinner",color:m.value}):T===!0?K($e,{class:"q-tree__arrow"+(t.expanded===!0?" q-tree__arrow--rotate":""),name:c.value,onClick(V){we(a,t,V)}}):null,t.hasTicking===!0&&t.noTick!==!0?K(pt,{class:"q-tree__tickbox",modelValue:t.indeterminate===!0?null:t.ticked,color:m.value,dark:x.value,dense:!0,keepColor:!0,disable:t.tickable!==!0,onKeydown:Re,"onUpdate:modelValue":V=>{Ie(t,V)}}):null,K("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(t.selected===!0?G.value:y.value)},[h?h(se):[J(a),K("div",a[e.labelKey])]])]),T===!0?e.noTransition===!0?t.expanded===!0?K("div",{class:"q-tree__node-collapsible"+y.value,key:`${r}__q`},[O,K("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]):null:K(Nt,{duration:e.duration,onShow:ge,onHide:ie},()=>lt(K("div",{class:"q-tree__node-collapsible"+y.value,key:`${r}__q`},[O,K("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]),[[xt,t.expanded]])):O])}function _e(a){const r=v[a];r&&r.focus()}function ue(a,r,t,h){h!==!0&&r.selectable!==!1&&_e(r.key),Q.value&&r.selectable?e.noSelectionUnset===!1?f("update:selected",r.key!==e.selected?r.key:null):r.key!==e.selected&&f("update:selected",r.key===void 0?null:r.key):we(a,r,t,h),typeof a.handler=="function"&&a.handler(a)}function we(a,r,t,h){t!==void 0&&Re(t),h!==!0&&r.selectable!==!1&&_e(r.key),he(r.key,!r.expanded,a,r)}function Ie(a,r){if(a.indeterminate===!0&&(r=a.indeterminateNextState),a.strictTicking)b([a.key],r);else if(a.leafTicking){const t=[],h=o=>{o.isParent?(r!==!0&&o.noTick!==!0&&o.tickable===!0&&t.push(o.key),o.leafTicking===!0&&o.children.forEach(h)):o.noTick!==!0&&o.tickable===!0&&(o.leafFilteredTicking!==!0||o.matchesFilter===!0)&&t.push(o.key)};h(a),b(t,r)}}return e.defaultExpandAll===!0&&be(),Object.assign(A,{getNodeByKey:L,getTickedNodes:W,getExpandedNodes:ae,isExpanded:ke,collapseAll:le,expandAll:be,setExpanded:he,isTicked:n,setTicked:b}),()=>{const a=I(e.nodes);return K("div",{class:i.value,role:"tree"},a.length===0?e.filter?e.noResultsLabel||B.lang.tree.noResults:e.noNodesLabel||B.lang.tree.noNodes:a)}}});const zt={__name:"CategoryTree",setup(e){const C=Se(),f=String("https://api.aa.dllib.ru/"),A=Ge(),B=St(),x=z("CategoriesList"),d=z("expandedCategNode"),M=z("selCategId"),q=z("selCategNode"),v=$(null);z("categMode"),D(M,()=>{if(!v.value)return;let c=v.value.getNodeByKey(M.value);if(c){let m=v.value.getNodeByKey(c.parent);q.value=c,d.value=[m.parent,c.parent]}else q.value=null},{deep:!0}),Te(()=>{Q()});function i(){A.path!=="/category"&&B.push({path:"/category"})}function Q(){Ce.post(f+"api/options.php",{params:{method:"getCategories"}}).then(c=>{var m,y,G;if(!((m=c==null?void 0:c.data)!=null&&m.result))throw new Error;c.data.result&&(x.value=(G=(y=c==null?void 0:c.data)==null?void 0:y.data)!=null?G:[])}).catch(c=>{C.notify(Le(c,"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u043D\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u043B\u0438\u0441\u044C"))})}return(c,m)=>k(x)?(w(),P(xe,{key:0,separator:"",dark:""},{default:u(()=>[s(ee,null,{default:u(()=>[s(Vt,{dark:"",color:"gray","control-color":"black",ref_key:"tree",ref:v,accordion:"",nodes:k(x),"label-key":"name",expanded:k(d),"onUpdate:expanded":m[0]||(m[0]=y=>Fe(d)?d.value=y:null),selected:k(M),"onUpdate:selected":[m[1]||(m[1]=y=>Fe(M)?M.value=y:null),i],"no-transition":"","selected-color":"orange","node-key":"id",dense:""},null,8,["nodes","expanded","selected"])]),_:1})]),_:1})):X("",!0)}},Ut=["src"],Gt={__name:"DrawerContent",setup(e){const C=Ge(),f=Se(),A=z("AccountList"),B=[{title:"\u041F\u0430\u043A\u0438",caption:"\u0420\u0430\u0441\u043A\u0440\u044B\u0432\u0430\u0435\u043C\u044B\u0439",ava:"/img/pack.png",children:[{title:"\u041F\u0430\u043A\u0438",caption:"\u0422\u0430\u0431\u043B\u0438\u0446\u0430 \u043F\u0430\u043A\u043E\u0432",ava:"/img/pack.png",link:"/packs"},{title:"\u041F\u0430\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u041A\u0430\u043B\u044C\u043A\u0443\u043B\u044F\u0442\u043E\u0440 \u043F\u0430\u043A\u043E\u0432",ava:"/img/packmaker.png",link:"/packinfo"}]},{title:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B",caption:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0441\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438",ava:"/img/crafcul.png",children:[{title:"\u041A\u0440\u0430\u0444\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0441\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438",link:"/item/"},{title:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",caption:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B \u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",link:"/category"}]},{title:"\u041C\u043E\u0438 \u0446\u0435\u043D\u044B",caption:"\u0426\u0435\u043D\u044B \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u043E\u0432",ava:"/img/myprices.png",link:"/myprices/"},{title:"\u0421\u043E\u043E\u0431\u0449\u0435\u0441\u0442\u0432\u043E",caption:"\u0426\u0435\u043D\u044B \u0438\u0433\u0440\u043E\u043A\u043E\u0432",ava:"/img/community.png",link:"/members"},{title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",caption:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u0442\u0435 \u0441\u0432\u043E\u0438 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B",ava:"/img/settings.png",link:"/settings"}],x=z("ServerGroupList"),d=p(()=>!!C.path.match(/^\/item\//)||!!C.path.match(/^\/category/));return Te(()=>{}),(M,q)=>(w(),re(ye,null,[k(f).platform.is.mobile?(w(),re(ye,{key:0},[k(A)&&k(A).some(v=>v.authType!=="default")?(w(),P(ot,{key:0})):(w(),P(ut,{key:1}))],64)):X("",!0),s(Ot,{separator:""},{default:u(()=>[s(Z,{header:""},{default:u(()=>q[0]||(q[0]=[U(" Graph Tools ")])),_:1}),(w(),re(ye,null,Ee(B,v=>(w(),re(ye,{key:v.title},[(v==null?void 0:v.children)&&(v==null?void 0:v.children.length)?(w(),P(Pt,{key:0,"content-inset-level":.2,"expand-separator":"",label:v.title,caption:v.caption,"default-closed":""},{header:u(()=>[v!=null&&v.ava?(w(),P(ee,{key:0,avatar:""},{default:u(()=>[s(Be,null,{default:u(()=>[fe("img",{src:v.ava},null,8,Ut)]),_:2},1024)]),_:2},1024)):X("",!0),s(ee,null,{default:u(()=>[U(ve(v.title),1)]),_:2},1024)]),default:u(()=>[(w(!0),re(ye,null,Ee(v.children,i=>(w(),P(Je,Oe({key:i.title,ref_for:!0},i,{title:i.title}),null,16,["title"]))),128))]),_:2},1032,["label","caption"])):(w(),P(Je,Oe({key:v.title,ref_for:!0},v,{title:v.title}),null,16,["title"]))],64))),64)),d.value&&k(x).length?(w(),P(zt,{key:0})):X("",!0)]),_:1})],64))}};var Wt=Qe({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:C}){const f=p(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>K("div",{class:f.value},We(C.default))}}),Rt=Qe({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:C}){const f=p(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>K("div",{class:f.value,role:"toolbar"},We(C.default))}});const Ye=150;var Ht=Qe({name:"QDrawer",inheritAttrs:!1,props:{...wt,...et,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...Ct,"onLayout","miniState"],setup(e,{slots:C,emit:f,attrs:A}){const B=at(),{proxy:{$q:x}}=B,d=tt(e,x),{preventBodyScroll:M}=Bt(),{registerTimeout:q,removeTimeout:v}=Lt(),i=z($t,Ne);if(i===Ne)return console.error("QDrawer needs to be child of QLayout"),Ne;let Q,c=null,m;const y=$(e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint),G=p(()=>e.mini===!0&&y.value!==!0),F=p(()=>G.value===!0?e.miniWidth:e.width),g=$(e.showIfAbove===!0&&y.value===!1?!0:e.modelValue===!0),L=p(()=>e.persistent!==!0&&(y.value===!0||we.value===!0));function W(l,_){if(be(),l!==!1&&i.animate(),R(0),y.value===!0){const H=i.instances[ie.value];H!==void 0&&H.belowBreakpoint===!0&&H.hide(!1),Y(1),i.isContainer.value!==!0&&M(!0)}else Y(0),l!==!1&&me(!1);q(()=>{l!==!1&&me(!0),_!==!0&&f("show",l)},Ye)}function ae(l,_){he(),l!==!1&&i.animate(),Y(0),R(b.value*F.value),pe(),_!==!0?q(()=>{f("hide",l)},Ye):v()}const{show:ke,hide:le}=Tt({showing:g,hideOnRouteChange:L,handleShow:W,handleHide:ae}),{addToHistory:be,removeFromHistory:he}=At(g,le,L),ne={belowBreakpoint:y,hide:le},n=p(()=>e.side==="right"),b=p(()=>(x.lang.rtl===!0?-1:1)*(n.value===!0?1:-1)),N=$(0),I=$(!1),J=$(!1),ge=$(F.value*b.value),ie=p(()=>n.value===!0?"left":"right"),oe=p(()=>g.value===!0&&y.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:F.value:0),_e=p(()=>e.overlay===!0||e.miniToOverlay===!0||i.view.value.indexOf(n.value?"R":"L")!==-1||x.platform.is.ios===!0&&i.isContainer.value===!0),ue=p(()=>e.overlay===!1&&g.value===!0&&y.value===!1),we=p(()=>e.overlay===!0&&g.value===!0&&y.value===!1),Ie=p(()=>"fullscreen q-drawer__backdrop"+(g.value===!1&&I.value===!1?" hidden":"")),a=p(()=>({backgroundColor:`rgba(0,0,0,${N.value*.4})`})),r=p(()=>n.value===!0?i.rows.value.top[2]==="r":i.rows.value.top[0]==="l"),t=p(()=>n.value===!0?i.rows.value.bottom[2]==="r":i.rows.value.bottom[0]==="l"),h=p(()=>{const l={};return i.header.space===!0&&r.value===!1&&(_e.value===!0?l.top=`${i.header.offset}px`:i.header.space===!0&&(l.top=`${i.header.size}px`)),i.footer.space===!0&&t.value===!1&&(_e.value===!0?l.bottom=`${i.footer.offset}px`:i.footer.space===!0&&(l.bottom=`${i.footer.size}px`)),l}),o=p(()=>{const l={width:`${F.value}px`,transform:`translateX(${ge.value}px)`};return y.value===!0?l:Object.assign(l,h.value)}),T=p(()=>"q-drawer__content fit "+(i.isContainer.value!==!0?"scroll":"overflow-auto")),O=p(()=>`q-drawer q-drawer--${e.side}`+(J.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(d.value===!0?" q-drawer--dark q-dark":"")+(I.value===!0?" no-transition":g.value===!0?"":" q-layout--prevent-focus")+(y.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${G.value===!0?"mini":"standard"}`+(_e.value===!0||ue.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(r.value===!0?" q-drawer--top-padding":""))),se=p(()=>{const l=x.lang.rtl===!0?e.side:ie.value;return[[Pe,S,void 0,{[l]:!0,mouse:!0}]]}),V=p(()=>{const l=x.lang.rtl===!0?ie.value:e.side;return[[Pe,E,void 0,{[l]:!0,mouse:!0}]]}),Ke=p(()=>{const l=x.lang.rtl===!0?ie.value:e.side;return[[Pe,E,void 0,{[l]:!0,mouse:!0,mouseAllDir:!0}]]});function ce(){st(y,e.behavior==="mobile"||e.behavior!=="desktop"&&i.totalWidth.value<=e.breakpoint)}D(y,l=>{l===!0?(Q=g.value,g.value===!0&&le(!1)):e.overlay===!1&&e.behavior!=="mobile"&&Q!==!1&&(g.value===!0?(R(0),Y(0),pe()):ke(!1))}),D(()=>e.side,(l,_)=>{i.instances[_]===ne&&(i.instances[_]=void 0,i[_].space=!1,i[_].offset=0),i.instances[l]=ne,i[l].size=F.value,i[l].space=ue.value,i[l].offset=oe.value}),D(i.totalWidth,()=>{(i.isContainer.value===!0||document.qScrollPrevented!==!0)&&ce()}),D(()=>e.behavior+e.breakpoint,ce),D(i.isContainer,l=>{g.value===!0&&M(l!==!0),l===!0&&ce()}),D(i.scrollbarWidth,()=>{R(g.value===!0?0:void 0)}),D(oe,l=>{te("offset",l)}),D(ue,l=>{f("onLayout",l),te("space",l)}),D(n,()=>{R()}),D(F,l=>{R(),Me(e.miniToOverlay,l)}),D(()=>e.miniToOverlay,l=>{Me(l,F.value)}),D(()=>x.lang.rtl,()=>{R()}),D(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(de(),i.animate())}),D(G,l=>{f("miniState",l)});function R(l){l===void 0?De(()=>{l=g.value===!0?0:F.value,R(b.value*l)}):(i.isContainer.value===!0&&n.value===!0&&(y.value===!0||Math.abs(l)===F.value)&&(l+=b.value*i.scrollbarWidth.value),ge.value=l)}function Y(l){N.value=l}function me(l){const _=l===!0?"remove":i.isContainer.value!==!0?"add":"";_!==""&&document.body.classList[_]("q-body--drawer-toggle")}function de(){c!==null&&clearTimeout(c),B.proxy&&B.proxy.$el&&B.proxy.$el.classList.add("q-drawer--mini-animate"),J.value=!0,c=setTimeout(()=>{c=null,J.value=!1,B&&B.proxy&&B.proxy.$el&&B.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function S(l){if(g.value!==!1)return;const _=F.value,H=qe(l.distance.x,0,_);if(l.isFinal===!0){H>=Math.min(75,_)===!0?ke():(i.animate(),Y(0),R(b.value*_)),I.value=!1;return}R((x.lang.rtl===!0?n.value!==!0:n.value)?Math.max(_-H,0):Math.min(0,H-_)),Y(qe(H/_,0,1)),l.isFirst===!0&&(I.value=!0)}function E(l){if(g.value!==!0)return;const _=F.value,H=l.direction===e.side,Ae=(x.lang.rtl===!0?H!==!0:H)?qe(l.distance.x,0,_):0;if(l.isFinal===!0){Math.abs(Ae)<Math.min(75,_)===!0?(i.animate(),Y(1),R(0)):le(),I.value=!1;return}R(b.value*Ae),Y(qe(1-Ae/_,0,1)),l.isFirst===!0&&(I.value=!0)}function pe(){M(!1),me(!0)}function te(l,_){i.update(e.side,l,_)}function st(l,_){l.value!==_&&(l.value=_)}function Me(l,_){te("size",l===!0?e.miniWidth:_)}return i.instances[e.side]=ne,Me(e.miniToOverlay,F.value),te("space",ue.value),te("offset",oe.value),e.showIfAbove===!0&&e.modelValue!==!0&&g.value===!0&&e["onUpdate:modelValue"]!==void 0&&f("update:modelValue",!0),Te(()=>{f("onLayout",ue.value),f("miniState",G.value),Q=e.showIfAbove===!0;const l=()=>{(g.value===!0?W:ae)(!1,!0)};if(i.totalWidth.value!==0){De(l);return}m=D(i.totalWidth,()=>{m(),m=void 0,g.value===!1&&e.showIfAbove===!0&&y.value===!1?ke(!1):l()})}),qt(()=>{m!==void 0&&m(),c!==null&&(clearTimeout(c),c=null),g.value===!0&&pe(),i.instances[e.side]===ne&&(i.instances[e.side]=void 0,te("size",0),te("offset",0),te("space",!1))}),()=>{const l=[];y.value===!0&&(e.noSwipeOpen===!1&&l.push(lt(K("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),se.value)),l.push(je("div",{ref:"backdrop",class:Ie.value,style:a.value,"aria-hidden":"true",onClick:le},void 0,"backdrop",e.noSwipeBackdrop!==!0&&g.value===!0,()=>Ke.value)));const _=G.value===!0&&C.mini!==void 0,H=[K("div",{...A,key:""+_,class:[T.value,A.class]},_===!0?C.mini():We(C.default))];return e.elevated===!0&&g.value===!0&&H.push(K("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(je("aside",{ref:"content",class:O.value,style:o.value},H,"contentclose",e.noSwipeClose!==!0&&y.value===!0,()=>V.value)),K("div",{class:"q-drawer-container"},l)}}});const jt=Qt({__name:"MainHeader",emits:["reLogin"],setup(e,{emit:C}){const f=Se(),A=String("https://auth.symphograph.ru/"),B=C,x=$(!1),d=z("AccountList"),M=z("curAccount");function q(){x.value=!x.value}function v(){console.log("curAccount",M.value)}return(i,Q)=>(w(),re(ye,null,[s(vt,{elevated:""},{default:u(()=>[s(Rt,null,{default:u(()=>[s(Xe,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:q}),s(Wt,null,{default:u(()=>Q[3]||(Q[3]=[U(" GraphTools ")])),_:1}),Q[4]||(Q[4]=fe("div",{style:{margin:"auto",color:"red"}},"* \u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u043A\u0435 *",-1)),k(f).platform.is.desktop?(w(),P(Et,{key:0,"inline-label":"",class:"bg-primary text-white shadow-2",align:"center"},{default:u(()=>[s(Xe,{label:"test",onClick:Q[0]||(Q[0]=c=>v())}),k(d)&&k(d).some(c=>c.authType!=="default")?(w(),P(ot,{key:0,onOnSelectAccount:Q[1]||(Q[1]=c=>B("reLogin"))})):(w(),P(ut,{key:1}))]),_:1})):(w(),P(Ve,{key:1,locIcon:k(A)+k(M).Avatar.src,grade:k(Ue).self.grade,onClick:q},null,8,["locIcon","grade"]))]),_:1})]),_:1}),s(Ht,{modelValue:x.value,"onUpdate:modelValue":Q[2]||(Q[2]=c=>x.value=c),"show-if-above":"",behavior:"default",bordered:"",dark:!0},{default:u(()=>[s(Gt)]),_:1},8,["modelValue"])],64))}}),Xt={class:"col"},Jt={class:"column full-height"},pa={__name:"MidLayout",emits:["reLogin"],setup(e,{emit:C}){const f=Se(),A=String("https://api.aa.dllib.ru/"),B=String("https://auth.symphograph.ru/"),x=Ge();z("progress");const d=z("isOptionsLoaded"),M=C,q=$([]);j("AccountList",q);const v=$({settings:{}});j("curAccount",v);const i=$({});j("AccSets",i);const Q=$([]);j("AccSetList",Q);const c=$([]);j("ServerGroupList",c);function m(){let n=q.value.map(b=>{const N=Q.value.find(I=>I.accountId===b.id);return N?{...b,settings:N}:b});q.value=n.sort((b,N)=>new Date(N.visitedAt)-new Date(b.visitedAt))}const y=$(0);j("selCategId",y);const G=$(null);j("selCategNode",G);const F=$([]);j("ProfLvls",F);const g=$([{id:2,label:"\u0422\u0435\u043B\u0435\u0433\u0440\u0430\u043C",url:"auth/telegram/login.php",img:"/img/auth/telegram.svg"},{id:3,label:"MailRu",url:"auth/mailru/login.php",img:"/img/auth/mailru.svg"},{id:4,label:"Discord",url:"auth/discord/login.php",img:"/img/auth/discord.svg"},{id:4,label:"V\u041A\u043E\u043D\u0442\u0430\u043A\u0442\u0435",url:"auth/vkontakte/login.php",img:"/img/auth/vkontakte.svg"}]);j("authTypes",g);const L=$(null);j("CategoriesList",L);const W=$([]);j("expandedCategNode",W);const ae=$(!1);j("categMode",ae),j("selectOptionsStyle",{backgroundColor:"rgb(181 238 8 / 93%)",color:"#4B3A23"});function le(){Ce.post(A+"api/options.php",{params:{method:"getMain"}}).then(n=>{var b,N,I,J,ge,ie,oe;if(!((b=n==null?void 0:n.data)!=null&&b.result))throw new Error;c.value=(J=(I=(N=n==null?void 0:n.data)==null?void 0:N.data)==null?void 0:I.ServerGroupList)!=null?J:[],F.value=(oe=(ie=(ge=n==null?void 0:n.data)==null?void 0:ge.data)==null?void 0:ie.ProfLvls)!=null?oe:[],be()}).catch(n=>{f.notify(Le(n))})}function be(){Ce.post(B+"api/account.php",{params:{method:"list"}}).then(n=>{var N,I;if(!((N=n==null?void 0:n.data)!=null&&N.result))throw new Error;let b=(I=n==null?void 0:n.data)==null?void 0:I.data;v.value=b.find(J=>J.id===ze.self.accountId()),q.value=b.filter(J=>J.authType!=="default"),he()}).catch(n=>{console.error(n),f.notify(Le(n))})}function he(){Ce.post(A+"api/settings.php",{params:{method:"get"}}).then(n=>{var b,N,I;if(!((b=n==null?void 0:n.data)!=null&&b.result))throw new Error;i.value=(N=n==null?void 0:n.data)==null?void 0:N.data,v.value.settings=(I=n==null?void 0:n.data)==null?void 0:I.data,Ue.self=new Ue(n.data.data),ne()}).catch(n=>{f.notify(Le(n))})}function ne(){Ce.post(A+"api/settings.php",{params:{method:"list",ids:q.value.map(n=>n.id)}}).then(n=>{var b,N,I;if(!((b=n==null?void 0:n.data)!=null&&b.result))throw new Error;Q.value=(I=(N=n==null?void 0:n.data)==null?void 0:N.data)!=null?I:[],m(),d.value=!0}).catch(n=>{f.notify(Le(n))})}return D(x,n=>{gt.set("lastPath",n.path)}),It(()=>{console.log("midLayout BeforeMount")}),Te(()=>{le()}),(n,b)=>{const N=Kt("router-view");return k(d)?(w(),P(dt,{key:0,view:"lHh Lpr lFf"},{default:u(()=>[s(jt,{onReLogin:b[0]||(b[0]=I=>M("reLogin"))}),v.value?(w(),P(ft,{key:0},{default:u(()=>[s(ct,{class:"row no-wrap"},{default:u(()=>[fe("div",Xt,[fe("div",Jt,[k(d)?(w(),P(N,{key:0})):X("",!0)])])]),_:1})]),_:1})):X("",!0),s(ht,null,{default:u(()=>b[1]||(b[1]=[fe("div",{class:"footer"},[U("\xA9 "),fe("a",{href:"https://vk.com/roman_chubich",target:"_blank"},"\u0413\u0440\u0430\u0444"),U(" * "),fe("a",{href:"https://github.com/symphograph/ArcheAgeTools_Frontend",target:"_blank"},"Github"),U(" * \u0428\u0430\u0435\u0434\u0430 ")],-1)])),_:1})]),_:1})):X("",!0)}}};export{pa as default};
