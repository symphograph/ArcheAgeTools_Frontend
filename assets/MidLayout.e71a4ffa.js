import{H as Be,c as m,h as q,I as Ee,J as ot,K as He,L as ut,M as je,N as ct,i as L,O as Ne,P as st,r as C,Q as dt,R as ft,w as F,o as $e,n as Me,S as vt,U as Je,V as De,g as Xe,W as ht,s as A,v as E,X as c,f as d,Y as Ve,Z as U,_ as Se,$ as k,a0 as mt,t as pe,l as Z,a1 as Ye,a2 as Ze,a3 as qe,F as Ae,a4 as et,b as Oe,a5 as ge,a6 as gt,a7 as yt,a8 as kt,a9 as bt,aa as _t,ab as Ue,ac as St,ad as We,u as ze,m as pt,p as j,k as xt,q as wt,ae as Ge}from"./index.d89fa4fe.js";import{Q as Tt}from"./QTabs.24535ccf.js";import{Q as Ct,a as Lt}from"./QFooter.9885e321.js";import{T as Pe}from"./TouchPan.05265af2.js";import{b as Le}from"./format.865294d5.js";import{Q as At}from"./QPage.15e64e61.js";import{Q as qt,a as Bt}from"./QLayout.b91ec74e.js";import{api as be}from"./axios.71ccf725.js";import{P as $t}from"./LocalStorage.e86d2bd3.js";import{u as Te}from"./use-quasar.957d8cc7.js";import{Q as ce,a as le,b as we}from"./position-engine.d4481b10.js";import{Q as tt}from"./QSelect.4c6b2588.js";import{I as Fe}from"./ItemIcon.b554a7df.js";import{Q as at,a as Qt}from"./QSlideTransition.ace1bb1c.js";import{d as It,n as _e,a as Kt}from"./myFuncts.b0c6cefc.js";import{Q as Nt}from"./QList.d6209427.js";import"./QScrollObserver.0c6f73e9.js";import"./selection.dd4e187a.js";import"./QMenu.19360e34.js";import"./jwt-decode.esm.81f958e7.js";var Pt=Be({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:T}){const s=m(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>q("div",{class:s.value},Ee(T.default))}}),Mt=Be({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:T}){const s=m(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>q("div",{class:s.value,role:"toolbar"},Ee(T.default))}});const Re=150;var Ot=Be({name:"QDrawer",inheritAttrs:!1,props:{...ot,...He,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},noMiniAnimation:Boolean,breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...ut,"onLayout","miniState"],setup(e,{slots:T,emit:s,attrs:I}){const x=Xe(),{proxy:{$q:_}}=x,v=je(e,_),{preventBodyScroll:K}=ht(),{registerTimeout:B,removeTimeout:M}=ct(),n=L(st,Ne);if(n===Ne)return console.error("QDrawer needs to be child of QLayout"),Ne;let J,S=null,$;const h=C(e.behavior==="mobile"||e.behavior!=="desktop"&&n.totalWidth.value<=e.breakpoint),W=m(()=>e.mini===!0&&h.value!==!0),w=m(()=>W.value===!0?e.miniWidth:e.width),u=C(e.showIfAbove===!0&&h.value===!1?!0:e.modelValue===!0),X=m(()=>e.persistent!==!0&&(h.value===!0||xe.value===!0));function Q(l,g){if(ye(),l!==!1&&n.animate(),D(0),h.value===!0){const G=n.instances[oe.value];G!==void 0&&G.belowBreakpoint===!0&&G.hide(!1),Y(1),n.isContainer.value!==!0&&K(!0)}else Y(0),l!==!1&&me(!1);B(()=>{l!==!1&&me(!0),g!==!0&&s("show",l)},Re)}function ee(l,g){he(),l!==!1&&n.animate(),Y(0),D(H.value*w.value),ke(),g!==!0?B(()=>{s("hide",l)},Re):M()}const{show:te,hide:ie}=dt({showing:u,hideOnRouteChange:X,handleShow:Q,handleHide:ee}),{addToHistory:ye,removeFromHistory:he}=ft(u,ie,X),re={belowBreakpoint:h,hide:ie},R=m(()=>e.side==="right"),H=m(()=>(_.lang.rtl===!0?-1:1)*(R.value===!0?1:-1)),r=C(0),b=C(!1),O=C(!1),z=C(w.value*H.value),oe=m(()=>R.value===!0?"left":"right"),se=m(()=>u.value===!0&&h.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:w.value:0),ue=m(()=>e.overlay===!0||e.miniToOverlay===!0||n.view.value.indexOf(R.value?"R":"L")>-1||_.platform.is.ios===!0&&n.isContainer.value===!0),ae=m(()=>e.overlay===!1&&u.value===!0&&h.value===!1),xe=m(()=>e.overlay===!0&&u.value===!0&&h.value===!1),Qe=m(()=>"fullscreen q-drawer__backdrop"+(u.value===!1&&b.value===!1?" hidden":"")),a=m(()=>({backgroundColor:`rgba(0,0,0,${r.value*.4})`})),i=m(()=>R.value===!0?n.rows.value.top[2]==="r":n.rows.value.top[0]==="l"),t=m(()=>R.value===!0?n.rows.value.bottom[2]==="r":n.rows.value.bottom[0]==="l"),f=m(()=>{const l={};return n.header.space===!0&&i.value===!1&&(ue.value===!0?l.top=`${n.header.offset}px`:n.header.space===!0&&(l.top=`${n.header.size}px`)),n.footer.space===!0&&t.value===!1&&(ue.value===!0?l.bottom=`${n.footer.offset}px`:n.footer.space===!0&&(l.bottom=`${n.footer.size}px`)),l}),o=m(()=>{const l={width:`${w.value}px`,transform:`translateX(${z.value}px)`};return h.value===!0?l:Object.assign(l,f.value)}),p=m(()=>"q-drawer__content fit "+(n.isContainer.value!==!0?"scroll":"overflow-auto")),N=m(()=>`q-drawer q-drawer--${e.side}`+(O.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(v.value===!0?" q-drawer--dark q-dark":"")+(b.value===!0?" no-transition":u.value===!0?"":" q-layout--prevent-focus")+(h.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${W.value===!0?"mini":"standard"}`+(ue.value===!0||ae.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(i.value===!0?" q-drawer--top-padding":""))),de=m(()=>{const l=_.lang.rtl===!0?e.side:oe.value;return[[Pe,y,void 0,{[l]:!0,mouse:!0}]]}),V=m(()=>{const l=_.lang.rtl===!0?oe.value:e.side;return[[Pe,P,void 0,{[l]:!0,mouse:!0}]]}),Ie=m(()=>{const l=_.lang.rtl===!0?oe.value:e.side;return[[Pe,P,void 0,{[l]:!0,mouse:!0,mouseAllDir:!0}]]});function fe(){rt(h,e.behavior==="mobile"||e.behavior!=="desktop"&&n.totalWidth.value<=e.breakpoint)}F(h,l=>{l===!0?(J=u.value,u.value===!0&&ie(!1)):e.overlay===!1&&e.behavior!=="mobile"&&J!==!1&&(u.value===!0?(D(0),Y(0),ke()):te(!1))}),F(()=>e.side,(l,g)=>{n.instances[g]===re&&(n.instances[g]=void 0,n[g].space=!1,n[g].offset=0),n.instances[l]=re,n[l].size=w.value,n[l].space=ae.value,n[l].offset=se.value}),F(n.totalWidth,()=>{(n.isContainer.value===!0||document.qScrollPrevented!==!0)&&fe()}),F(()=>e.behavior+e.breakpoint,fe),F(n.isContainer,l=>{u.value===!0&&K(l!==!0),l===!0&&fe()}),F(n.scrollbarWidth,()=>{D(u.value===!0?0:void 0)}),F(se,l=>{ne("offset",l)}),F(ae,l=>{s("onLayout",l),ne("space",l)}),F(R,()=>{D()}),F(w,l=>{D(),Ke(e.miniToOverlay,l)}),F(()=>e.miniToOverlay,l=>{Ke(l,w.value)}),F(()=>_.lang.rtl,()=>{D()}),F(()=>e.mini,()=>{e.noMiniAnimation||e.modelValue===!0&&(ve(),n.animate())}),F(W,l=>{s("miniState",l)});function D(l){l===void 0?Me(()=>{l=u.value===!0?0:w.value,D(H.value*l)}):(n.isContainer.value===!0&&R.value===!0&&(h.value===!0||Math.abs(l)===w.value)&&(l+=H.value*n.scrollbarWidth.value),z.value=l)}function Y(l){r.value=l}function me(l){const g=l===!0?"remove":n.isContainer.value!==!0?"add":"";g!==""&&document.body.classList[g]("q-body--drawer-toggle")}function ve(){S!==null&&clearTimeout(S),x.proxy&&x.proxy.$el&&x.proxy.$el.classList.add("q-drawer--mini-animate"),O.value=!0,S=setTimeout(()=>{S=null,O.value=!1,x&&x.proxy&&x.proxy.$el&&x.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function y(l){if(u.value!==!1)return;const g=w.value,G=Le(l.distance.x,0,g);if(l.isFinal===!0){G>=Math.min(75,g)===!0?te():(n.animate(),Y(0),D(H.value*g)),b.value=!1;return}D((_.lang.rtl===!0?R.value!==!0:R.value)?Math.max(g-G,0):Math.min(0,G-g)),Y(Le(G/g,0,1)),l.isFirst===!0&&(b.value=!0)}function P(l){if(u.value!==!0)return;const g=w.value,G=l.direction===e.side,Ce=(_.lang.rtl===!0?G!==!0:G)?Le(l.distance.x,0,g):0;if(l.isFinal===!0){Math.abs(Ce)<Math.min(75,g)===!0?(n.animate(),Y(1),D(0)):ie(),b.value=!1;return}D(H.value*Ce),Y(Le(1-Ce/g,0,1)),l.isFirst===!0&&(b.value=!0)}function ke(){K(!1),me(!0)}function ne(l,g){n.update(e.side,l,g)}function rt(l,g){l.value!==g&&(l.value=g)}function Ke(l,g){ne("size",l===!0?e.miniWidth:g)}return n.instances[e.side]=re,Ke(e.miniToOverlay,w.value),ne("space",ae.value),ne("offset",se.value),e.showIfAbove===!0&&e.modelValue!==!0&&u.value===!0&&e["onUpdate:modelValue"]!==void 0&&s("update:modelValue",!0),$e(()=>{s("onLayout",ae.value),s("miniState",W.value),J=e.showIfAbove===!0;const l=()=>{(u.value===!0?Q:ee)(!1,!0)};if(n.totalWidth.value!==0){Me(l);return}$=F(n.totalWidth,()=>{$(),$=void 0,u.value===!1&&e.showIfAbove===!0&&h.value===!1?te(!1):l()})}),vt(()=>{$!==void 0&&$(),S!==null&&(clearTimeout(S),S=null),u.value===!0&&ke(),n.instances[e.side]===re&&(n.instances[e.side]=void 0,ne("size",0),ne("offset",0),ne("space",!1))}),()=>{const l=[];h.value===!0&&(e.noSwipeOpen===!1&&l.push(Je(q("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),de.value)),l.push(De("div",{ref:"backdrop",class:Qe.value,style:a.value,"aria-hidden":"true",onClick:ie},void 0,"backdrop",e.noSwipeBackdrop!==!0&&u.value===!0,()=>Ie.value)));const g=W.value===!0&&T.mini!==void 0,G=[q("div",{...I,key:""+g,class:[p.value,I.class]},g===!0?T.mini():Ee(T.default))];return e.elevated===!0&&u.value===!0&&G.push(q("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),l.push(De("aside",{ref:"content",class:N.value,style:o.value},G,"contentclose",e.noSwipeClose!==!0&&h.value===!0,()=>V.value)),q("div",{class:"q-drawer-container"},l)}}});const lt={__name:"DynamicFormItem",props:{btnLabel:String,icon:String,url:String},setup(e){const T=e;Te();const s=L("AccessToken"),I=L("SessionToken");return(x,_)=>(A(),E(we,{clickable:"",dark:"",onClick:_[0]||(_[0]=v=>k(It)(e.url,{AccessToken:k(s),SessionToken:k(I)}))},{default:c(()=>[d(ce,{avatar:""},{default:c(()=>[d(Ve,null,{default:c(()=>[d(at,{src:e.icon},null,8,["src"])]),_:1})]),_:1}),d(ce,null,{default:c(()=>[d(le,{caption:""},{default:c(()=>[U("\u0412\u043E\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437")]),_:1}),d(le,null,{default:c(()=>[U(Se(T.btnLabel),1)]),_:1})]),_:1})]),_:1}))}},Ft={key:0,style:{width:"40px"}},it={__name:"AccountSelector",emits:["onSelectAccount"],setup(e,{emit:T}){Te();const s=String("https://auth.symphograph.ru/");L("AccessToken"),L("SessionToken");const I=L("ServerGroupList"),x=L("AccountList"),_=C(null),v=L("curAccount"),K=m(()=>[...x.value].filter(u=>u.authType!=="default")),B=L("AccSets"),M=L("AccSetList"),n=C({id:1,nickName:"\u041D\u0435 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D",avatar:"init_ava.png",grade:1,serverId:9}),J=L("authTypes");m(()=>{var w;return!_.value||!x.value?!1:(w=x.value.find(u=>u.id===_.value))!=null?w:n.value});const S=C(null),$=L("reLogin");function h(w){return M.value.find(u=>u.accountId===w)}function W(w){return I.value.find(u=>u.id===w)}return(w,u)=>{var X;return k(x)?(A(),E(tt,{key:0,modelValue:k(v),"onUpdate:modelValue":[u[0]||(u[0]=Q=>Oe(v)?v.value=Q:null),u[1]||(u[1]=Q=>k($)(k(v).id,k(v).authType))],style:{"min-width":"16em"},ref_key:"selector",ref:S,dark:"","label-color":"grey",filled:"",label:(X=k(B).publicNick)!=null?X:"",options:K.value,"option-value":"id","map-options":"","option-label":"nickName"},mt({"before-options":c(()=>[d(we,{clickable:"",to:"/account"},{default:c(()=>[d(ce,{avatar:""},{default:c(()=>[d(Ve,{icon:"ionicon person outline"})]),_:1}),d(ce,null,{default:c(()=>[d(le,{caption:"",class:"text-grey"},{default:c(()=>[U("\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0430\u043A\u043A\u0430\u0443\u043D\u0442\u0430")]),_:1}),d(le,null,{default:c(()=>[U("\u041F\u0440\u043E\u0444\u0438\u043B\u044C")]),_:1})]),_:1})]),_:1})]),option:c(Q=>[Q.opt.id!==k(v).id&&Q.opt.authType!=="default"?(A(),E(we,Ye(Ze({key:0},Q.itemProps)),{default:c(()=>[d(ce,{avatar:""},{default:c(()=>[d(Fe,{locIcon:k(s)+Q.opt.Avatar.src,grade:1,size:"70px"},null,8,["locIcon"])]),_:2},1024),d(ce,null,{default:c(()=>[d(le,{caption:"",class:"text-grey-9"},{default:c(()=>[U(" \u0412\u043E\u0439\u0442\u0438 \u043A\u0430\u043A "),d(qe,{name:"img:/img/auth/"+Q.opt.authType+".svg"},null,8,["name"])]),_:2},1024),d(le,null,{default:c(()=>[U(Se(Q.opt.nickName),1)]),_:2},1024),d(le,{caption:"",class:"text-grey-6"},{default:c(()=>{var ee,te;return[U(Se((te=(ee=h(Q.opt.id))==null?void 0:ee.publicNick)!=null?te:""),1)]}),_:2},1024),d(le,{caption:"",class:"text-grey-9"},{default:c(()=>{var ee;return[U(Se(W((ee=h(Q.opt.id))==null?void 0:ee.serverGroupId).label),1)]}),_:2},1024)]),_:2},1024)]),_:2},1040)):Z("",!0)]),"after-options":c(()=>[(A(!0),pe(Ae,null,et(k(J),Q=>(A(),pe("div",{key:Q.id},[d(lt,{btnLabel:Q.label,icon:Q.img,url:k(s)+Q.url},null,8,["btnLabel","icon","url"])]))),128))]),_:2},[k(v)?{name:"append",fn:c(()=>[k(v).Avatar?(A(),pe("div",Ft,[d(Fe,{locIcon:k(s)+k(v).Avatar.src,grade:k(B).grade},null,8,["locIcon","grade"])])):Z("",!0)]),key:"0"}:void 0]),1032,["modelValue","label","options"])):Z("",!0)}}},nt={__name:"LoginList",setup(e){const T=String("https://auth.symphograph.ru/"),s=L("authTypes");L("AccessToken"),L("SessionToken");const I=C(null);return(x,_)=>(A(),E(tt,{modelValue:I.value,"onUpdate:modelValue":_[0]||(_[0]=v=>I.value=v),options:k(s),"map-options":"",label:"\u0412\u043E\u0439\u0442\u0438",style:{"min-width":"16em"},ref:"selector",dark:"",filled:"","option-value":"id","label-color":"grey"},{option:c(v=>[ge("div",Ye(gt(v.itemProps)),[d(lt,{btnLabel:v.opt.label,icon:v.opt.img,url:k(T)+v.opt.url},null,8,["btnLabel","icon","url"])],16)]),_:1},8,["modelValue","options"]))}},Et={__name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:"#"},icon:{type:String,default:""},ava:{type:String,default:""}},setup(e){return(T,s)=>(A(),E(we,{clickable:"",tag:"a",to:e.link,dark:""},{default:c(()=>[e.icon||e.ava?(A(),E(ce,{key:0,avatar:""},{default:c(()=>[e.icon?(A(),E(qe,{key:0,name:e.icon},null,8,["name"])):Z("",!0),e.ava?(A(),E(Ve,{key:1},{default:c(()=>[d(at,{src:e.ava,ratio:30/30},null,8,["src"])]),_:1})):Z("",!0)]),_:1})):Z("",!0),d(ce,null,{default:c(()=>[d(le,null,{default:c(()=>[U(Se(e.title),1)]),_:1}),d(le,{caption:""},{default:c(()=>[U(Se(e.caption),1)]),_:1})]),_:1})]),_:1},8,["to"]))}},Vt=["none","strict","leaf","leaf-filtered"];var zt=Be({name:"QTree",props:{...He,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>Vt.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:T,emit:s}){const{proxy:I}=Xe(),{$q:x}=I,_=je(e,x),v=C({}),K=C(e.ticked||[]),B=C(e.expanded||[]);let M={};yt(()=>{M={}});const n=m(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(_.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),J=m(()=>e.selected!==void 0),S=m(()=>e.icon||x.iconSet.tree.icon),$=m(()=>e.controlColor||e.color),h=m(()=>e.textColor!==void 0?` text-${e.textColor}`:""),W=m(()=>{const a=e.selectedColor||e.color;return a?` text-${a}`:""}),w=m(()=>e.filterMethod!==void 0?e.filterMethod:(a,i)=>{const t=i.toLowerCase();return a[e.labelKey]&&a[e.labelKey].toLowerCase().indexOf(t)>-1}),u=m(()=>{const a={},i=(t,f)=>{const o=t.tickStrategy||(f?f.tickStrategy:e.tickStrategy),p=t[e.nodeKey],N=t[e.childrenKey]&&Array.isArray(t[e.childrenKey])&&t[e.childrenKey].length!==0,de=t.disabled!==!0&&J.value===!0&&t.selectable!==!1,V=t.disabled!==!0&&t.expandable!==!1,Ie=o!=="none",fe=o==="strict",D=o==="leaf-filtered",Y=o==="leaf"||o==="leaf-filtered";let me=t.disabled!==!0&&t.tickable!==!1;Y===!0&&me===!0&&f&&f.tickable!==!0&&(me=!1);let ve=t.lazy;ve===!0&&v.value[p]!==void 0&&Array.isArray(t[e.childrenKey])===!0&&(ve=v.value[p]);const y={key:p,parent:f,isParent:N,lazy:ve,disabled:t.disabled,link:t.disabled!==!0&&(de===!0||V===!0&&(N===!0||ve===!0)),children:[],matchesFilter:e.filter?w.value(t,e.filter):!0,selected:p===e.selected&&de===!0,selectable:de,expanded:N===!0?B.value.includes(p):!1,expandable:V,noTick:t.noTick===!0||fe!==!0&&ve&&ve!=="loaded",tickable:me,tickStrategy:o,hasTicking:Ie,strictTicking:fe,leafFilteredTicking:D,leafTicking:Y,ticked:fe===!0?K.value.includes(p):N===!0?!1:K.value.includes(p)};if(a[p]=y,N===!0&&(y.children=t[e.childrenKey].map(P=>i(P,y)),e.filter&&(y.matchesFilter!==!0?y.matchesFilter=y.children.some(P=>P.matchesFilter):y.noTick!==!0&&y.disabled!==!0&&y.tickable===!0&&D===!0&&y.children.every(P=>P.matchesFilter!==!0||P.noTick===!0||P.tickable!==!0)===!0&&(y.tickable=!1)),y.matchesFilter===!0&&(y.noTick!==!0&&fe!==!0&&y.children.every(P=>P.noTick)===!0&&(y.noTick=!0),Y))){if(y.ticked=!1,y.indeterminate=y.children.some(P=>P.indeterminate===!0),y.tickable=y.tickable===!0&&y.children.some(P=>P.tickable),y.indeterminate!==!0){const P=y.children.reduce((ke,ne)=>ne.ticked===!0?ke+1:ke,0);P===y.children.length?y.ticked=!0:P>0&&(y.indeterminate=!0)}y.indeterminate===!0&&(y.indeterminateNextState=y.children.every(P=>P.tickable!==!0||P.ticked!==!0))}return y};return e.nodes.forEach(t=>i(t,null)),a});F(()=>e.ticked,a=>{K.value=a}),F(()=>e.expanded,a=>{B.value=a});function X(a){const i=[].reduce,t=(f,o)=>{if(f||!o)return f;if(Array.isArray(o)===!0)return i.call(Object(o),t,f);if(o[e.nodeKey]===a)return o;if(o[e.childrenKey])return t(null,o[e.childrenKey])};return t(null,e.nodes)}function Q(){return K.value.map(a=>X(a))}function ee(){return B.value.map(a=>X(a))}function te(a){return a&&u.value[a]?u.value[a].expanded:!1}function ie(){e.expanded!==void 0?s("update:expanded",[]):B.value=[]}function ye(){const a=[],i=t=>{t[e.childrenKey]&&t[e.childrenKey].length!==0&&t.expandable!==!1&&t.disabled!==!0&&(a.push(t[e.nodeKey]),t[e.childrenKey].forEach(i))};e.nodes.forEach(i),e.expanded!==void 0?s("update:expanded",a):B.value=a}function he(a,i,t=X(a),f=u.value[a]){if(f.lazy&&f.lazy!=="loaded"){if(f.lazy==="loading")return;v.value[a]="loading",Array.isArray(t[e.childrenKey])!==!0&&(t[e.childrenKey]=[]),s("lazyLoad",{node:t,key:a,done:o=>{v.value[a]="loaded",t[e.childrenKey]=Array.isArray(o)===!0?o:[],Me(()=>{const p=u.value[a];p&&p.isParent===!0&&re(a,!0)})},fail:()=>{delete v.value[a],t[e.childrenKey].length===0&&delete t[e.childrenKey]}})}else f.isParent===!0&&f.expandable===!0&&re(a,i)}function re(a,i){let t=B.value;const f=e.expanded!==void 0;if(f===!0&&(t=t.slice()),i){if(e.accordion&&u.value[a]){const o=[];u.value[a].parent?u.value[a].parent.children.forEach(p=>{p.key!==a&&p.expandable===!0&&o.push(p.key)}):e.nodes.forEach(p=>{const N=p[e.nodeKey];N!==a&&o.push(N)}),o.length!==0&&(t=t.filter(p=>o.includes(p)===!1))}t=t.concat([a]).filter((o,p,N)=>N.indexOf(o)===p)}else t=t.filter(o=>o!==a);f===!0?s("update:expanded",t):B.value=t}function R(a){return a&&u.value[a]?u.value[a].ticked:!1}function H(a,i){let t=K.value;const f=e.ticked!==void 0;f===!0&&(t=t.slice()),i?t=t.concat(a).filter((o,p,N)=>N.indexOf(o)===p):t=t.filter(o=>a.includes(o)===!1),f===!0&&s("update:ticked",t)}function r(a,i,t){const f={tree:I,node:a,key:t,color:e.color,dark:_.value};return We(f,"expanded",()=>i.expanded,o=>{o!==i.expanded&&he(t,o)}),We(f,"ticked",()=>i.ticked,o=>{o!==i.ticked&&H([t],o)}),f}function b(a){return(e.filter?a.filter(i=>u.value[i[e.nodeKey]].matchesFilter):a).map(i=>se(i))}function O(a){if(a.icon!==void 0)return q(qe,{class:"q-tree__icon q-mr-sm",name:a.icon,color:a.iconColor});const i=a.img||a.avatar;if(i)return q("img",{class:`q-tree__${a.img?"img":"avatar"} q-mr-sm`,src:i})}function z(){s("afterShow")}function oe(){s("afterHide")}function se(a){const i=a[e.nodeKey],t=u.value[i],f=a.header&&T[`header-${a.header}`]||T["default-header"],o=t.isParent===!0?b(a[e.childrenKey]):[],p=o.length!==0||t.lazy&&t.lazy!=="loaded";let N=a.body&&T[`body-${a.body}`]||T["default-body"];const de=f!==void 0||N!==void 0?r(a,t,i):null;return N!==void 0&&(N=q("div",{class:"q-tree__node-body relative-position"},[q("div",{class:h.value},[N(de)])])),q("div",{key:i,class:`q-tree__node relative-position q-tree__node--${p===!0?"parent":"child"}`},[q("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(t.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(t.selected===!0?" q-tree__node--selected":"")+(t.disabled===!0?" q-tree__node--disabled":""),tabindex:t.link===!0?0:-1,onClick:V=>{ae(a,t,V)},onKeypress(V){kt(V)!==!0&&(V.keyCode===13?ae(a,t,V,!0):V.keyCode===32&&xe(a,t,V,!0))}},[q("div",{class:"q-focus-helper",tabindex:-1,ref:V=>{M[t.key]=V}}),t.lazy==="loading"?q(bt,{class:"q-tree__spinner",color:$.value}):p===!0?q(qe,{class:"q-tree__arrow"+(t.expanded===!0?" q-tree__arrow--rotate":""),name:S.value,onClick(V){xe(a,t,V)}}):null,t.hasTicking===!0&&t.noTick!==!0?q(_t,{class:"q-tree__tickbox",modelValue:t.indeterminate===!0?null:t.ticked,color:$.value,dark:_.value,dense:!0,keepColor:!0,disable:t.tickable!==!0,onKeydown:Ue,"onUpdate:modelValue":V=>{Qe(t,V)}}):null,q("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(t.selected===!0?W.value:h.value)},[f?f(de):[O(a),q("div",a[e.labelKey])]])]),p===!0?e.noTransition===!0?t.expanded===!0?q("div",{class:"q-tree__node-collapsible"+h.value,key:`${i}__q`},[N,q("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":"")},o)]):null:q(Qt,{duration:e.duration,onShow:z,onHide:oe},()=>Je(q("div",{class:"q-tree__node-collapsible"+h.value,key:`${i}__q`},[N,q("div",{class:"q-tree__children"+(t.disabled===!0?" q-tree__node--disabled":"")},o)]),[[St,t.expanded]])):N])}function ue(a){const i=M[a];i&&i.focus()}function ae(a,i,t,f){f!==!0&&i.selectable!==!1&&ue(i.key),J.value&&i.selectable?e.noSelectionUnset===!1?s("update:selected",i.key!==e.selected?i.key:null):i.key!==e.selected&&s("update:selected",i.key===void 0?null:i.key):xe(a,i,t,f),typeof a.handler=="function"&&a.handler(a)}function xe(a,i,t,f){t!==void 0&&Ue(t),f!==!0&&i.selectable!==!1&&ue(i.key),he(i.key,!i.expanded,a,i)}function Qe(a,i){if(a.indeterminate===!0&&(i=a.indeterminateNextState),a.strictTicking)H([a.key],i);else if(a.leafTicking){const t=[],f=o=>{o.isParent?(i!==!0&&o.noTick!==!0&&o.tickable===!0&&t.push(o.key),o.leafTicking===!0&&o.children.forEach(f)):o.noTick!==!0&&o.tickable===!0&&(o.leafFilteredTicking!==!0||o.matchesFilter===!0)&&t.push(o.key)};f(a),H(t,i)}}return e.defaultExpandAll===!0&&ye(),Object.assign(I,{getNodeByKey:X,getTickedNodes:Q,getExpandedNodes:ee,isExpanded:te,collapseAll:ie,expandAll:ye,setExpanded:he,isTicked:R,setTicked:H}),()=>{const a=b(e.nodes);return q("div",{class:n.value},a.length===0?e.filter?e.noResultsLabel||x.lang.tree.noResults:e.noNodesLabel||x.lang.tree.noNodes:a)}}});const Dt={__name:"CategoryTree",setup(e){const T=Te(),s=String("https://api.aa.dllib.ru/"),I=ze(),x=pt(),_=L("CategoriesList"),v=L("expandedCategNode"),K=L("selCategId"),B=L("selCategNode"),M=C(null);L("categMode"),F(K,()=>{if(!M.value)return;let S=M.value.getNodeByKey(K.value);if(S){let $=M.value.getNodeByKey(S.parent);B.value=S,v.value=[$.parent,S.parent]}else B.value=null},{deep:!0}),$e(()=>{J()});function n(){I.path!=="/category"&&x.push({path:"/category"})}function J(){be.post(s+"api/get/categories.php",{params:{}}).then(S=>{var $,h,W;if(!(($=S==null?void 0:S.data)!=null&&$.result))throw new Error;S.data.result&&(_.value=(W=(h=S==null?void 0:S.data)==null?void 0:h.data)!=null?W:[])}).catch(S=>{T.notify(_e(S,"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438 \u043D\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u043B\u0438\u0441\u044C"))})}return(S,$)=>k(_)?(A(),E(we,{key:0,separator:"",dark:""},{default:c(()=>[d(ce,null,{default:c(()=>[d(zt,{dark:"",color:"gray","control-color":"black",ref_key:"tree",ref:M,accordion:"",nodes:k(_),"label-key":"name",expanded:k(v),"onUpdate:expanded":$[0]||($[0]=h=>Oe(v)?v.value=h:null),selected:k(K),"onUpdate:selected":[$[1]||($[1]=h=>Oe(K)?K.value=h:null),n],"no-transition":"","selected-color":"orange","node-key":"id",dense:""},null,8,["nodes","expanded","selected"])]),_:1})]),_:1})):Z("",!0)}},Ut={__name:"DrawerContent",setup(e){const T=ze(),s=Te(),I=L("AccountList"),x=[{title:"\u041F\u0430\u043A\u0438",caption:"\u0422\u0430\u0431\u043B\u0438\u0446\u0430 \u043F\u0430\u043A\u043E\u0432",ava:"/img/pack.png",link:"/packs"},{title:"\u041F\u0430\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u041A\u0430\u043B\u044C\u043A\u0443\u043B\u044F\u0442\u043E\u0440 \u043F\u0430\u043A\u043E\u0432",ava:"/img/packmaker.png",link:"/packinfo"},{title:"\u041A\u0440\u0430\u0444\u043A\u0443\u043B\u044F\u0442\u043E\u0440",caption:"\u0420\u0430\u0441\u0447\u0435\u0442 \u0441\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u0438",ava:"/img/crafcul.png",link:"/item/"},{title:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",caption:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442\u044B \u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",ava:"/img/crafcul.png",link:"/category"},{title:"\u041C\u043E\u0438 \u0446\u0435\u043D\u044B",caption:"\u0426\u0435\u043D\u044B \u043F\u0440\u0435\u0434\u043C\u0435\u0442\u043E\u0432",ava:"/img/myprices.png",link:"/myprices/"},{title:"\u0421\u043E\u043E\u0431\u0449\u0435\u0441\u0442\u0432\u043E",caption:"\u0426\u0435\u043D\u044B \u0438\u0433\u0440\u043E\u043A\u043E\u0432",ava:"/img/comunity.png",link:"/members"},{title:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",caption:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u0442\u0435 \u0441\u0432\u043E\u0438 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B",ava:"/img/settings.png",link:"/account"}],_=L("ServerGroupList"),v=m(()=>!!T.path.match(/^\/item\//)||!!T.path.match(/^\/category/));return $e(()=>{}),(K,B)=>(A(),pe(Ae,null,[k(s).platform.is.mobile?(A(),pe(Ae,{key:0},[k(I)&&k(I).length>1?(A(),E(it,{key:0})):(A(),E(nt,{key:1}))],64)):Z("",!0),d(Nt,{separator:""},{default:c(()=>[d(le,{header:""},{default:c(()=>[U(" Graph Tools ")]),_:1}),(A(),pe(Ae,null,et(x,M=>d(Et,Ze({key:M.title},M,{title:M.title}),null,16,["title"])),64)),v.value&&k(_).length?(A(),E(Dt,{key:0})):Z("",!0)]),_:1})],64))}},Wt=ge("div",{style:{margin:"auto",color:"red"}},"* \u0412 \u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u043A\u0435 *",-1),Gt={class:"col"},Rt={class:"column full-height"},Ht=ge("div",{class:"footer"},[U("\xA9 "),ge("a",{href:"https://vk.com/roman_chubich",target:"_blank"},"\u0413\u0440\u0430\u0444"),U(" * "),ge("a",{href:"https://github.com/symphograph/ArcheAgeTools_Frontend",target:"_blank"},"Github"),U(" * \u0428\u0430\u0435\u0434\u0430 ")],-1),ga={__name:"MidLayout",emits:["reLogin"],setup(e,{emit:T}){const s=Te(),I=String("https://api.aa.dllib.ru/"),x=String("https://auth.symphograph.ru/"),_=ze();L("progress");const v=L("AccessToken"),K=L("isOptionsLoaded");L("isTokenRefreshed");const B=C([]);j("AccountList",B);const M=C(null);j("curAccount",M);const n=C({grade:1,serverGroupId:100});j("AccSets",n);const J=C(0);j("selCategId",J);const S=C(null);j("selCategNode",S);const $=C([]);j("ServerGroupList",$);const h=C([]);j("ProfLvls",h);const W=C([{id:2,label:"\u0422\u0435\u043B\u0435\u0433\u0440\u0430\u043C",url:"auth/telegram/login.php",img:"/img/auth/telegram.svg"},{id:3,label:"MailRu",url:"auth/mailru/login.php",img:"/img/auth/mailru.svg"},{id:4,label:"Discord",url:"auth/discord/login.php",img:"/img/auth/discord.svg"},{id:4,label:"V\u041A\u043E\u043D\u0442\u0430\u043A\u0442\u0435",url:"auth/vkontakte/login.php",img:"/img/auth/vkontakte.svg"}]);j("authTypes",W);const w=C(!1),u=C(null);j("CategoriesList",u);const X=C([]);j("expandedCategNode",X);const Q=C(!1);j("categMode",Q),j("selectOptionsStyle",{backgroundColor:"rgb(181 238 8 / 93%)",color:"#4B3A23"});const te=C([]);j("AccSetList",te);function ie(){w.value=!w.value}function ye(){be.post(I+"api/get/options.php").then(r=>{var b,O,z,oe,se,ue,ae;if(!((b=r==null?void 0:r.data)!=null&&b.result))throw new Error;$.value=(oe=(z=(O=r==null?void 0:r.data)==null?void 0:O.data)==null?void 0:z.ServerGroupList)!=null?oe:[],h.value=(ae=(ue=(se=r==null?void 0:r.data)==null?void 0:se.data)==null?void 0:ue.ProfLvls)!=null?ae:[],re()}).catch(r=>{s.notify(_e(r))})}function he(){be.post(x+"api/test.php",{params:{method:"get"}}).then(r=>{var b;if(!((b=r==null?void 0:r.data)!=null&&b.result))throw new Error}).catch(r=>{s.notify(_e(r))})}function re(){be.post(x+"api/account.php",{params:{method:"list"}}).then(r=>{var b,O;if(!((b=r==null?void 0:r.data)!=null&&b.result))throw new Error;B.value=(O=r==null?void 0:r.data)==null?void 0:O.data,M.value=B.value.find(z=>z.id===Kt(v.value)),R()}).catch(r=>{s.notify(_e(r))})}function R(){be.post(I+"api/settings.php",{params:{method:"get"}}).then(r=>{var b,O;if(!((b=r==null?void 0:r.data)!=null&&b.result))throw new Error;n.value=(O=r==null?void 0:r.data)==null?void 0:O.data,H()}).catch(r=>{s.notify(_e(r))})}function H(){be.post(I+"api/settings.php",{params:{method:"list",ids:B.value.map(r=>r.id)}}).then(r=>{var b,O,z;if(!((b=r==null?void 0:r.data)!=null&&b.result))throw new Error;te.value=(z=(O=r==null?void 0:r.data)==null?void 0:O.data)!=null?z:[],K.value=!0}).catch(r=>{s.notify(_e(r))})}return F(_,r=>{$t.set("lastPath",r.path)}),xt(()=>{}),$e(()=>{ye()}),(r,b)=>{const O=wt("router-view");return k(K)?(A(),E(qt,{key:0,view:"lHh Lpr lFf"},{default:c(()=>[d(Ct,{elevated:""},{default:c(()=>[d(Mt,null,{default:c(()=>[d(Ge,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:ie}),d(Pt,null,{default:c(()=>[U(" GraphTools ")]),_:1}),Wt,k(s).platform.is.desktop?(A(),E(Tt,{key:0,"inline-label":"",class:"bg-primary text-white shadow-2",align:"center"},{default:c(()=>[d(Ge,{label:"test",onClick:b[0]||(b[0]=z=>he())}),B.value?(A(),E(it,{key:0,onOnSelectAccount:b[1]||(b[1]=z=>T("reLogin"))})):(A(),E(nt,{key:1}))]),_:1})):(A(),E(Fe,{key:1,locIcon:k(x)+M.value.Avatar.src,grade:n.value.grade,onClick:ie},null,8,["locIcon","grade"]))]),_:1})]),_:1}),d(Ot,{modelValue:w.value,"onUpdate:modelValue":b[2]||(b[2]=z=>w.value=z),"show-if-above":"",behavior:"default",bordered:"",dark:""},{default:c(()=>[d(Ut)]),_:1},8,["modelValue"]),M.value?(A(),E(Bt,{key:0},{default:c(()=>[d(At,{class:"row no-wrap"},{default:c(()=>[ge("div",Gt,[ge("div",Rt,[k(K)?(A(),E(O,{key:0})):Z("",!0)])])]),_:1})]),_:1})):Z("",!0),d(Lt,null,{default:c(()=>[Ht]),_:1})]),_:1})):Z("",!0)}}};export{ga as default};
