import{i as F,r as d,$ as u,s as h,v as x,a0 as ue,X as l,f as a,a3 as ie,b3 as ce,Z as k,_ as b,l as Q,a2 as de,Y as G,a5 as m,b as H,av as J,be as ve,b4 as pe,b5 as fe,p as I,c as s,w as me,o as ye,t as K,ba as V,bb as _e,b9 as q}from"./index.8b7d4eab.js";import{Q as Pe}from"./QLinearProgress.eecf1eda.js";import{_ as Ie,Z as ke,a as he}from"./SideButtons.1d92b1bf.js";import{api as D}from"./axios.5aa6e63e.js";import{n as W}from"./myFuncts.568a70aa.js";import{u as ge}from"./use-quasar.90e44688.js";import{b as X,Q as j,a as T}from"./position-engine.7c83a723.js";import{Q as ee}from"./QSelect.e75683dc.js";import{I as Y}from"./ItemIcon.13e8f2d1.js";import{N as Se,S as ze}from"./SalaryCard.82e99f2d.js";/* empty css                                                                   */import"./jwt-decode.esm.81f958e7.js";import"./selection.a873ab56.js";import"./QMenu.19960b50.js";import"./format.865294d5.js";import"./QList.52d1291c.js";import"./PriceImagerComponent.cb816649.js";const Fe=["src"],be={__name:"PackSelect",emits:["onSelect"],setup(g,{emit:y}){const _=F("ptSettings"),i=F("filteredPackList"),P=d([...i.value]),e=F("selectedPack"),v=F("selectOptionsStyle");d([]);function p(n,c,r){if(n===""){c(()=>{P.value=[...i.value]});return}c(()=>{const O=n.toLowerCase();let z=[...i.value];n&&(z=[...z].filter(B=>B.Pack.name.toLowerCase().indexOf(O)>-1)),P.value=z})}function S(){e.value=null,_.value.zoneFromId=0,_.value.zoneToId=0}return(n,c)=>u(i).length?(h(),x(ee,{key:0,options:P.value,modelValue:u(e),"onUpdate:modelValue":[c[0]||(c[0]=r=>H(e)?e.value=r:null),c[1]||(c[1]=r=>y("onSelect"))],"popup-content-style":u(v),"use-input":"","fill-input":"","map-options":"","option-value":"id","option-label":"name","hide-selected":"",onFilter:p},ue({label:l(()=>[k("jhj")]),"selected-item":l(()=>[Object.keys(u(e)).length?(h(),x(X,{key:0,dense:""},{default:l(()=>[a(j,{avatar:""}),a(j,null,{default:l(()=>[a(T,null,{default:l(()=>[k(b(u(e).Pack.name),1)]),_:1}),a(T,{caption:""},{default:l(()=>[k(b(u(e).ZoneFrom.name),1)]),_:1}),a(T,{caption:""},{default:l(()=>[k(b(u(e).ZoneTo.name),1)]),_:1})]),_:1})]),_:1})):Q("",!0)]),option:l(r=>[a(X,de(r.itemProps,{dense:""}),{default:l(()=>[a(j,{avatar:""},{default:l(()=>[a(G,{size:"1.5em",style:{position:"absolute",top:"-0.3em",left:"0.5em","z-index":"99"}},{default:l(()=>[m("img",{src:"/img/packtypes/"+r.opt.Pack.typeId+".png",alt:""},null,8,Fe)]),_:2},1024),a(Y,{icon:r.opt.Pack.icon,grade:r.opt.Pack.grade,size:"60px"},null,8,["icon","grade"])]),_:2},1024),a(j,null,{default:l(()=>[a(T,null,{default:l(()=>[k(b(r.opt.Pack.name),1)]),_:2},1024),a(T,{caption:""},{default:l(()=>[k(b(r.opt.ZoneFrom.name),1)]),_:2},1024),a(T,{caption:""},{default:l(()=>[k(b(r.opt.ZoneTo.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:2},[u(e)?{name:"prepend",fn:l(()=>[a(Y,{icon:u(e).Pack.icon,grade:u(e).Pack.grade,size:"60px"},null,8,["icon","grade"])]),key:"0"}:void 0,u(e)?{name:"append",fn:l(()=>[a(ie,{name:"cancel",onClick:ce(S,["stop","prevent"]),class:"cursor-pointer"},null,8,["onClick"])]),key:"1"}:void 0]),1032,["options","modelValue","popup-content-style"])):Q("",!0)}},Te=g=>(pe("data-v-764a5c61"),g=g(),fe(),g),xe=Te(()=>m("img",{src:"/img/time.png"},null,-1)),Le={__name:"FreshSelect",setup(g){const y=F("selectedFresh"),_=F("selectedPack"),i=d("Input"),P=F("selectOptionsStyle");return(e,v)=>(h(),x(ee,{options:u(_).Freshness.FreshLvls,"map-options":"","option-value":"lvl","option-label":"name",borderless:"",dense:"",modelValue:u(y),"onUpdate:modelValue":v[0]||(v[0]=p=>H(y)?y.value=p:null),class:ve(i.value),onFocus:v[1]||(v[1]=p=>i.value="Input InputActive"),onBlur:v[2]||(v[2]=p=>i.value="Input"),"popup-content-style":u(P)},{prepend:l(()=>[a(G,null,{default:l(()=>[xe]),_:1})]),_:1},8,["options","modelValue","class","popup-content-style"]))}};var we=J(Le,[["__scopeId","data-v-764a5c61"]]);const Ce={class:"paculatorArea"},$e={style:{display:"flex","justify-content":"space-evenly",width:"100%"}},Ze={style:{width:"100%",display:"flex","justify-content":"center"}},Qe={style:{display:"flex","justify-content":"space-evenly"}},Ve={__name:"PackCalculator",setup(g){const y=ge(),_=String("https://api.aa.dllib.ru/"),i=d({}),P=d([]),e=d({zoneFromId:0,zoneToId:0,side:0,siol:!1,ratePercent:130});I("ptSettings",e);const v=s(()=>N.value);I("disabled",v);const p=s(()=>{if(!Object.keys(i.value).length||!e.value.side)return[{id:0,name:"\u0412\u0441\u0435"}];let t=[...i.value[e.value.side]];return t.unshift({id:0,name:"\u0412\u0441\u0435",ZonesTo:P.value[e.value.side]}),t});I("zonesFrom",p);const S=s(()=>{if(!p.value.length||!e.value.side)return[{id:0,name:"\u0412\u0441\u0435"}];let t=[...p.value];return t=t.find(o=>o.id===e.value.zoneFromId),!t||!t.ZonesTo?[]:t.ZonesTo});I("zonesTo",S);const n=d(null);I("selectedPack",n);const c=d(null);I("selectedFresh",c);const r=d([]),O=d([]),z=d([]);I("currencyPrices",z);const B=s(()=>{if(!r.value.length)return[];let t=[...r.value];return e.value.zoneFromId?t.filter(o=>o.zoneFromId===e.value.zoneFromId):t}),A=s(()=>{let t=[...B.value];return e.value.zoneToId?t.filter(o=>o.zoneToId===e.value.zoneToId):t});I("filteredPackList",A);const N=d(!1);function te(){D.post(_+"api/get/zones.php").then(t=>{var o,f,L,w,C,$,Z;if(!((o=t==null?void 0:t.data)!=null&&o.result))throw new Error;P.value=(w=(L=(f=t==null?void 0:t.data)==null?void 0:f.data)==null?void 0:L.allZonesTo)!=null?w:[],i.value=(Z=($=(C=t==null?void 0:t.data)==null?void 0:C.data)==null?void 0:$.zonesFrom)!=null?Z:[]}).catch(t=>{y.notify(W(t,"\u041E\u0439! Zones \u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442 :(")),p.value=[]})}function ae(){N.value=!0,D.post(_+"api/get/packs.php",{params:{side:e.value.side,addProfit:!0}}).then(t=>{var o,f,L,w,C,$,Z;if(!((o=t==null?void 0:t.data)!=null&&o.result))throw new Error;r.value=(w=(L=(f=t==null?void 0:t.data)==null?void 0:f.data)==null?void 0:L.Packs)!=null?w:[],z.value=(Z=($=(C=t==null?void 0:t.data)==null?void 0:C.data)==null?void 0:$.currencyPrices)!=null?Z:[]}).catch(t=>{progress.value=!1,y.notify(W(t,"\u041E\u0439! Packs \u041D\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442 :(")),r.value=[],O.value=[]}).finally(()=>{N.value=!1})}function le(){e.value.zoneFromId=n.value.zoneFromId,e.value.zoneToId=n.value.zoneToId,c.value=n.value.Freshness.FreshLvls[n.value.Freshness.bestLvl]}function Me(){}function ne(){e.value.zoneFromId=0,e.value.zoneToId=0,ae()}s(()=>e.value.condition?n.value.Freshness.bestLvl:n.value.Freshness.worstLvl);const oe=s(()=>c.value.percent),E=s(()=>Math.round(n.value.dbPrice/130*100)),re=s(()=>e.value.siol&&n.value.currencyId===500?5:0),U=s(()=>E.value*(e.value.ratePercent/100)*(1+re.value/100)),M=s(()=>{let t=U.value*(1+oe.value/100);return t*=1.02,n.value.currencyId!==500&&(t/=100),Math.round(t)}),R=s(()=>{if(n.value.currencyId===500)return M.value;let t=M.value*z.value[n.value.currencyId].price*.9;return Math.round(t)}),se=s(()=>R.value-props.pRoute.Pack.craftPrice);return s(()=>Math.round(se.value/n.value.Pack.laborNeed)),me(()=>e.value.zoneFromId,()=>{if(e.value.zoneFromId&&S.value)return e.value.zoneFromId===e.value.zoneToId&&(e.value.zoneToId=S.value[0].id),S.value.length===2&&(e.value.zoneToId=S.value[1].id),!0;e.value.zoneToId=0}),ye(()=>{te()}),(t,o)=>(h(),K("div",Ce,[a(q,{class:"packCard"},{default:l(()=>[a(V,{horizontal:""},{default:l(()=>[m("div",$e,[a(Ie,{onSideSelected:o[0]||(o[0]=f=>ne())})]),m("div",null,[a(ke,{onOnSelect:o[1]||(o[1]=f=>void 0)}),a(he)]),m("div",Ze,[a(Se,{active:e.value.siol,imgBtn:"/img/siol.png",onClick:o[2]||(o[2]=f=>e.value.siol=!e.value.siol)},null,8,["active"])])]),_:1}),a(Pe,{"animation-speed":200,color:"green",indeterminate:v.value},null,8,["indeterminate"]),a(V,null,{default:l(()=>[A.value.length?(h(),x(be,{key:0,onOnSelect:le})):Q("",!0)]),_:1}),n.value?(h(),x(V,{key:0},{default:l(()=>[m("div",Qe,[m("div",null,[a(_e,{modelValue:e.value.ratePercent,"onUpdate:modelValue":o[3]||(o[3]=f=>e.value.ratePercent=f),class:"Input",dense:"",style:{width:"9em",height:"max-content",margin:"0"},suffix:"%",borderless:"",type:"number",step:"5",max:"130",min:"50"},null,8,["modelValue"])]),a(we)])]),_:1})):Q("",!0),n.value?(h(),x(V,{key:1},{default:l(()=>[a(ze,{siol:e.value.siol,ratePercent:e.value.ratePercent,freshPercent:c.value.percent,dbPrice:n.value.dbPrice,currencyId:n.value.currencyId,goldSalary:R.value,factoryPrice:U.value,flatSalary:E.value,finalSalary:M.value},null,8,["siol","ratePercent","freshPercent","dbPrice","currencyId","goldSalary","factoryPrice","flatSalary","finalSalary"])]),_:1})):Q("",!0)]),_:1}),a(q,{class:"packCard"},{default:l(()=>[k("eee")]),_:1})]))}};var je=J(Ve,[["__scopeId","data-v-435671d0"]]);const Oe={class:"WindowArea column"},Be=m("div",{style:{display:"flex","justify-content":"center"}},[m("h1",null,"\u041F\u0430\u043A\u0418\u043D\u0444\u043E")],-1),Ne={class:"ItemArea"},nt={__name:"PackInfoPage",setup(g){return(y,_)=>(h(),K("div",Oe,[Be,m("div",Ne,[a(je)])]))}};export{nt as default};
